{"version":3,"sources":["webpack:///src/app/homepage/pages/microservices/basics/basics.component.ts","webpack:///src/app/homepage/pages/microservices/basics/basics.component.html","webpack:///src/app/homepage/pages/microservices/custom-transport/custom-transport.component.ts","webpack:///src/app/homepage/pages/microservices/custom-transport/custom-transport.component.html","webpack:///src/app/homepage/pages/microservices/exception-filters/exception-filters.component.ts","webpack:///src/app/homepage/pages/microservices/exception-filters/exception-filters.component.html","webpack:///src/app/homepage/pages/microservices/grpc/grpc.component.ts","webpack:///src/app/homepage/pages/microservices/grpc/grpc.component.html","webpack:///src/app/homepage/pages/microservices/guards/guards.component.ts","webpack:///src/app/homepage/pages/microservices/guards/guards.component.html","webpack:///src/app/homepage/pages/microservices/interceptors/interceptors.component.ts","webpack:///src/app/homepage/pages/microservices/interceptors/interceptors.component.html","webpack:///src/app/homepage/pages/microservices/kafka/kafka.component.ts","webpack:///src/app/homepage/pages/microservices/kafka/kafka.component.html","webpack:///src/app/homepage/pages/microservices/microservices.module.ts","webpack:///src/app/homepage/pages/microservices/mqtt/mqtt.component.ts","webpack:///src/app/homepage/pages/microservices/mqtt/mqtt.component.html","webpack:///src/app/homepage/pages/microservices/nats/nats.component.ts","webpack:///src/app/homepage/pages/microservices/nats/nats.component.html","webpack:///src/app/homepage/pages/microservices/pipes/pipes.component.ts","webpack:///src/app/homepage/pages/microservices/pipes/pipes.component.html","webpack:///src/app/homepage/pages/microservices/rabbitmq/rabbitmq.component.ts","webpack:///src/app/homepage/pages/microservices/rabbitmq/rabbitmq.component.html","webpack:///src/app/homepage/pages/microservices/redis/redis.component.ts","webpack:///src/app/homepage/pages/microservices/redis/redis.component.html"],"names":["BasicsComponent","selector","templateUrl","changeDetection","OnPush","CustomTransportComponent","MicroservicesExceptionFiltersComponent","GrpcComponent","MicroservicesGuardsComponent","MicroservicesInterceptorsComponent","KafkaComponent","routes","path","component","data","title","MicroservicesModule","forChild","imports","declarations","MqttComponent","NatsComponent","MicroservicesPipesComponent","RabbitMQComponent","RedisComponent"],"mappings":"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","file":"homepage-pages-microservices-microservices-module-es5.js","sourcesContent":["import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-basics',\n  templateUrl: './basics.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class BasicsComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/basics.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"overview\">Overview</h3>\n<p>In addition to traditional (sometimes called monolithic) application architectures, Nest natively supports the microservice architectural style of development. Most of the concepts discussed elsewhere in this documentation, such as dependency injection, decorators, exception filters, pipes, guards and interceptors, apply equally to microservices. Wherever possible, Nest abstracts implementation details so that the same components can run across HTTP-based platforms, WebSockets, and Microservices. This section covers the aspects of Nest that are specific to microservices.</p>\n<p>In Nest, a microservice is fundamentally an application that uses a different <strong>transport</strong> layer than HTTP.</p>\n<figure><img src=\"/assets/Microservices_1.png\" /></figure>\n\n<p>Nest supports several built-in transport layer implementations, called <strong>transporters</strong>, which are responsible for transmitting messages between different microservice instances. Most transporters natively support both <strong>request-response</strong> and <strong>event-based</strong> message styles. Nest abstracts the implementation details of each transporter behind a canonical interface for both request-response and event-based messaging. This makes it easy to switch from one transport layer to another -- for example to leverage the specific reliability or performance features of a particular transport layer -- without impacting your application code.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To start building microservices, first install the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save @nestjs/microservices</code></pre>\n<h4 appAnchor id=\"getting-started\"><span>Getting started</span></h4>\n<p>To instantiate a microservice, use the <code>createMicroservice()</code> method of the <code>NestFactory</code> class:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app9814fd58407933afe9beaafd5bdca718113ff177.isJsActive }}\n<app-tabs #app9814fd58407933afe9beaafd5bdca718113ff177></app-tabs>\n</span><pre><code class=\"language-typescript\">\nimport &#123; NestFactory &#125; from &#39;@nestjs/core&#39;;\nimport &#123; Transport &#125; from &#39;@nestjs/microservices&#39;;\nimport &#123; AppModule &#125; from &#39;./app.module&#39;;\n\nasync function bootstrap() &#123;\n  const app = await NestFactory.createMicroservice(AppModule, &#123;\n    transport: Transport.TCP,\n  &#125;);\n  app.listen(() =&gt; console.log(&#39;Microservice is listening&#39;));\n&#125;\nbootstrap();</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> Microservices use the <strong>TCP</strong> transport layer by default.\n</blockquote>\n<p>The second argument of the <code>createMicroservice()</code> method is an <code>options</code> object. This object may consist of two members:</p>\n<table>\n  <tr>\n    <td><code>transport</code></td>\n    <td>Specifies the transporter (for example, <code>Transport.NATS</code>)</td>\n  </tr>\n  <tr>\n    <td><code>options</code></td>\n    <td>A transporter-specific options object that determines transporter behavior</td>\n  </tr>\n</table>\n<p>\n  The <code>options</code> object is specific to the chosen transporter. The <strong>TCP</strong> transporter exposes\n  the properties described below.  For other transporters (e.g, Redis, MQTT, etc.), see the relevant chapter for a description of the available options.\n</p>\n<table>\n  <tr>\n    <td><code>host</code></td>\n    <td>Connection hostname</td>\n  </tr>\n  <tr>\n    <td><code>port</code></td>\n    <td>Connection port</td>\n  </tr>\n  <tr>\n    <td><code>retryAttempts</code></td>\n    <td>Number of times to retry message (default: <code>0</code>)</td>\n  </tr>\n  <tr>\n    <td><code>retryDelay</code></td>\n    <td>Delay between message retry attempts (ms) (default: <code>0</code>)</td>\n  </tr>\n</table>\n\n<h4 appAnchor id=\"patterns\"><span>Patterns</span></h4>\n<p>Microservices recognize both messages and events by <strong>patterns</strong>. A pattern is a plain value, for example, a literal object or a string. Patterns are automatically serialized and sent over the network along with the data portion of a message. In this way, message senders and consumers can coordinate which requests are consumed by which handlers.</p>\n<h4 appAnchor id=\"request-response\"><span>Request-response</span></h4>\n<p>The request-response message style is useful when you need to <strong>exchange</strong> messages between various external services. With this paradigm, you can be certain that the service has actually received the message (without the need to manually implement a message ACK protocol). However, the request-response paradigm is not always the best choice. For example, streaming transporters that use log-based persistence, such as <a rel='nofollow' target='_blank' href=\"https://docs.confluent.io/3.0.0/streams/\">Kafka</a> or <a rel='nofollow' target='_blank' href=\"https://github.com/nats-io/node-nats-streaming\">NATS streaming</a>, are optimized for solving a different range of issues, more aligned with an event messaging paradigm (see <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/microservices/basics#event-based\">event-based messaging</a> below for more details).</p>\n<p>To enable the request-response message type, Nest creates two logical channels - one is responsible for transferring the data while the other waits for incoming responses. For some underlying transports, such as <a rel='nofollow' target='_blank' href=\"https://nats.io/\">NATS</a>, this dual-channel support is provided out-of-the-box. For others, Nest compensates by manually creating separate channels. There can be overhead for this, so if you do not require a request-response message style, you should consider using the event-based method.</p>\n<p>To create a message handler based on the request-response paradigm use the <code>@MessagePattern()</code> decorator, which is imported from the <code>@nestjs/microservices</code> package.</p>\n\n<span class=\"filename\">\n  {{ 'math.controller' | extension: app76f54a1474922ab0e846f8cbfb6c364d5b3b90cb.isJsActive }}\n<app-tabs #app76f54a1474922ab0e846f8cbfb6c364d5b3b90cb></app-tabs>\n</span><pre [class.hide]=\"app76f54a1474922ab0e846f8cbfb6c364d5b3b90cb.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Controller &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MessagePattern &#125; from &#39;@nestjs/microservices&#39;;\n\n@Controller()\nexport class MathController &#123;\n  @MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\n  accumulate(data: number[]): number &#123;\n    return (data || []).reduce((a, b) =&gt; a + b);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app76f54a1474922ab0e846f8cbfb6c364d5b3b90cb.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Controller &#125; from &#39;@nestjs/common&#39;;\nimport &#123; MessagePattern &#125; from &#39;@nestjs/microservices&#39;;\n\n@Controller()\nexport class MathController &#123;\n  @MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\n  accumulate(data) &#123;\n    return (data || []).reduce((a, b) =&gt; a + b);\n  &#125;\n&#125;</code></pre><p>In the above code, the <code>accumulate()</code> <strong>message handler</strong> listens for messages that fulfill the <code>{{ &#39;{&#39; }} cmd: &#39;sum&#39; {{ &#39;}&#39; }}</code> message pattern. The message handler takes a single argument, the <code>data</code> passed from the client. In this case, the data is an array of numbers which are to be accumulated.</p>\n<h4 appAnchor id=\"asynchronous-responses\"><span>Asynchronous responses</span></h4>\n<p>Message handlers are able to respond either synchronously or <strong>asynchronously</strong>. Hence, <code>async</code> methods are supported.</p>\n\n<span class=\"filename\">\n<app-tabs #app50c229e41e99b5c5e5380405759df7ad880c91e8></app-tabs>\n</span><pre [class.hide]=\"app50c229e41e99b5c5e5380405759df7ad880c91e8.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\nasync accumulate(data: number[]): Promise&lt;number&gt; &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre>\n<pre [class.hide]=\"!app50c229e41e99b5c5e5380405759df7ad880c91e8.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\nasync accumulate(data) &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre><p>A message handler is also able to return an <code>Observable</code>, in which case the result values will be emitted until the stream is completed.</p>\n\n<span class=\"filename\">\n<app-tabs #appd225a43677bebbecd3aa42e54b56f05271cceab5></app-tabs>\n</span><pre [class.hide]=\"appd225a43677bebbecd3aa42e54b56f05271cceab5.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data: number[]): Observable&lt;number&gt; &#123;\n  return from([1, 2, 3]);\n&#125;</code></pre>\n<pre [class.hide]=\"!appd225a43677bebbecd3aa42e54b56f05271cceab5.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data: number[]): Observable&lt;number&gt; &#123;\n  return from([1, 2, 3]);\n&#125;</code></pre><p>In the example above, the message handler will respond <strong>3 times</strong> (with each item from the array).</p>\n<h4 appAnchor id=\"event-based\"><span>Event-based</span></h4>\n<p>While the request-response method is ideal for exchanging messages between services, it is less suitable when your message style is event-based - when you just want to publish <strong>events</strong> without waiting for a response. In that case, you do not want the overhead required by request-response for maintaining two channels.</p>\n<p>Suppose you would like to simply notify another service that a certain condition has occurred in this part of the system. This is the ideal use case for the event-based message style.</p>\n<p>To create an event handler, we use the <code>@EventPattern()</code> decorator, which is imported from the <code>@nestjs/microservices</code> package.</p>\n\n<span class=\"filename\">\n<app-tabs #app00bba0c5cdba5a14e1292061fb31fb885261d3a8></app-tabs>\n</span><pre [class.hide]=\"app00bba0c5cdba5a14e1292061fb31fb885261d3a8.isJsActive\"><code class=\"language-typescript\">\n@EventPattern(&#39;user_created&#39;)\nasync handleUserCreated(data: Record&lt;string, unknown&gt;) &#123;\n  // business logic\n&#125;</code></pre>\n<pre [class.hide]=\"!app00bba0c5cdba5a14e1292061fb31fb885261d3a8.isJsActive\"><code class=\"language-typescript\">\n@EventPattern(&#39;user_created&#39;)\nasync handleUserCreated(data) &#123;\n  // business logic\n&#125;</code></pre><p>The <code>handleUserCreated()</code> <strong>event handler</strong> listens for the <code>&#39;user_created&#39;</code> event. The event handler takes a single argument, the <code>data</code> passed from the client (in this case, an event payload which has been sent over the network).</p>\n<p><app-banner-enterprise></app-banner-enterprise></p>\n<h4 appAnchor id=\"decorators\"><span>Decorators</span></h4>\n<p>In more sophisticated scenarios, you may want to access more information about the incoming request. For example, in the case of NATS with wildcard subscriptions, you may want to get the original subject that the producer has sent the message to. Likewise, in Kafka you may want to access the message headers. In order to accomplish that, you can use built-in decorators as follows:</p>\n\n<span class=\"filename\">\n<app-tabs #app411251c3c48d24a4bf7cb21b5db3ad968230bdbf></app-tabs>\n</span><pre [class.hide]=\"app411251c3c48d24a4bf7cb21b5db3ad968230bdbf.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;time.us.*&#39;)\ngetDate(@Payload() data: number[], @Ctx() context: NatsContext) &#123;\n  console.log(`Subject: $&#123;context.getSubject()&#125;`); // e.g. &quot;time.us.east&quot;\n  return new Date().toLocaleTimeString(...);\n&#125;</code></pre>\n<pre [class.hide]=\"!app411251c3c48d24a4bf7cb21b5db3ad968230bdbf.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;time.us.*&#39;)\ngetDate(data, context) &#123;\n  console.log(`Subject: $&#123;context.getSubject()&#125;`); // e.g. &quot;time.us.east&quot;\n  return new Date().toLocaleTimeString(...);\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> <code>@Payload()</code>, <code>@Ctx()</code> and <code>NatsContext</code> are imported from <code>@nestjs/microservices</code>.\n</blockquote>\n<h4 appAnchor id=\"client\"><span>Client</span></h4>\n<p>A client Nest application can exchange messages or publish events to a Nest microservice using the <code>ClientProxy</code> class. This class defines several methods, such as <code>send()</code> (for request-response messaging) and <code>emit()</code> (for event-driven messaging) that let you communicate with a remote microservice. Obtain an instance of this class in one of the following ways.</p>\n<p>One technique is to import the <code>ClientsModule</code>, which exposes the static <code>register()</code> method. This method takes an argument which is an array of objects representing microservice transporters. Each such object has a <code>name</code> property, an optional <code>transport</code> property (default is <code>Transport.TCP</code>), and an optional transporter-specific <code>options</code> property.</p>\n<p>The <code>name</code> property serves as an <strong>injection token</strong> that can be used to inject an instance of a <code>ClientProxy</code> where needed. The value of the <code>name</code> property, as an injection token, can be an arbitrary string or JavaScript symbol, as described <a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/fundamentals/custom-providers#non-class-based-provider-tokens\">here</a>.</p>\n<p>The <code>options</code> property is an object with the same properties we saw in the <code>createMicroservice()</code> method earlier.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    ClientsModule.register([\n      &#123; name: &#39;MATH_SERVICE&#39;, transport: Transport.TCP &#125;,\n    ]),\n  ]\n  ...\n&#125;)</code></pre>\n<p>Once the module has been imported, we can inject an instance of the <code>ClientProxy</code> configured as specified via the <code>&#39;MATH_SERVICE&#39;</code> transporter options shown above, using the <code>@Inject()</code> decorator.</p>\n<pre><code class=\"language-typescript\">\nconstructor(\n  @Inject(&#39;MATH_SERVICE&#39;) private readonly client: ClientProxy,\n) &#123;&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>ClientsModule</code> and <code>ClientProxy</code> classes are imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<p>At times we may need to fetch the transporter configuration from another service (say a <code>ConfigService</code>), rather than hard-coding it in our client application. To do this, we can register a <a routerLink=\"/techniques/custom-providers\">custom provider</a> using the <code>ClientProxyFactory</code> class. This class has a static <code>create()</code> method, which accepts a transporter options object, and returns a customized <code>ClientProxy</code> instance.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  providers: [\n    &#123;\n      provide: &#39;MATH_SERVICE&#39;,\n      useFactory: (configService: ConfigService) =&gt; &#123;\n        const mathSvcOptions = configService.getMathSvcOptions();\n        return ClientProxyFactory.create(mathSvcOptions);\n      &#125;,\n      inject: [ConfigService],\n    &#125;\n  ]\n  ...\n&#125;)</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>ClientProxyFactory</code> is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<p>Another option is to use the <code>@Client()</code> property decorator.</p>\n<pre><code class=\"language-typescript\">\n@Client(&#123; transport: Transport.TCP &#125;)\nclient: ClientProxy;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>@Client()</code> decorator is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<p>Using the <code>@Client()</code> decorator is not the preferred technique, as it is harder to test and harder to share a client instance.</p>\n<p>The <code>ClientProxy</code> is <strong>lazy</strong>. It doesn&#39;t initiate a connection immediately. Instead, it will be established before the first microservice call, and then reused across each subsequent call. However, if you want to delay the application bootstrapping process until a connection is established, you can manually initiate a connection using the <code>ClientProxy</code> object&#39;s <code>connect()</code> method inside the <code>OnApplicationBootstrap</code> lifecycle hook.</p>\n\n<span class=\"filename\">\n<app-tabs #appe69d6d0bcc93d7904b0b1c9a9d2c47ac17ca87bb></app-tabs>\n</span><pre><code class=\"language-typescript\">\nasync onApplicationBootstrap() &#123;\n  await this.client.connect();\n&#125;</code></pre><p>If the connection cannot be created, the <code>connect()</code> method will reject with the corresponding error object.</p>\n<h4 appAnchor id=\"sending-messages\"><span>Sending messages</span></h4>\n<p>The <code>ClientProxy</code> exposes a <code>send()</code> method. This method is intended to call the microservice and returns an <code>Observable</code> with its response. Thus, we can subscribe to the emitted values easily.</p>\n\n<span class=\"filename\">\n<app-tabs #appd278c4a9936ed424feb63aa121b1e1ce3e17f39c></app-tabs>\n</span><pre [class.hide]=\"appd278c4a9936ed424feb63aa121b1e1ce3e17f39c.isJsActive\"><code class=\"language-typescript\">\naccumulate(): Observable&lt;number&gt; &#123;\n  const pattern = &#123; cmd: &#39;sum&#39; &#125;;\n  const payload = [1, 2, 3];\n  return this.client.send&lt;number&gt;(pattern, payload);\n&#125;</code></pre>\n<pre [class.hide]=\"!appd278c4a9936ed424feb63aa121b1e1ce3e17f39c.isJsActive\"><code class=\"language-typescript\">\naccumulate() &#123;\n  const pattern = &#123; cmd: &#39;sum&#39; &#125;;\n  const payload = [1, 2, 3];\n  return this.client.send(pattern, payload);\n&#125;</code></pre><p>The <code>send()</code> method takes two arguments, <code>pattern</code> and <code>payload</code>. The <code>pattern</code> should match one defined in a <code>@MessagePattern()</code> decorator. The <code>payload</code> is a message that we want to transmit to the remote microservice. This method returns a <strong>cold <code>Observable</code></strong>, which means that you have to explicitly subscribe to it before the message will be sent.</p>\n<h4 appAnchor id=\"publishing-events\"><span>Publishing events</span></h4>\n<p>To send an event, use the <code>ClientProxy</code> object&#39;s <code>emit()</code> method. This method publishes an event to the message broker.</p>\n\n<span class=\"filename\">\n<app-tabs #app39a0606f17efd57a26bfd6af2dff7997a978ac93></app-tabs>\n</span><pre [class.hide]=\"app39a0606f17efd57a26bfd6af2dff7997a978ac93.isJsActive\"><code class=\"language-typescript\">\nasync publish() &#123;\n  this.client.emit&lt;number&gt;(&#39;user_created&#39;, new UserCreatedEvent());\n&#125;</code></pre>\n<pre [class.hide]=\"!app39a0606f17efd57a26bfd6af2dff7997a978ac93.isJsActive\"><code class=\"language-typescript\">\nasync publish() &#123;\n  this.client.emit(&#39;user_created&#39;, new UserCreatedEvent());\n&#125;</code></pre><p>The <code>emit()</code> method takes two arguments, <code>pattern</code> and <code>payload</code>. The <code>pattern</code>should match one defined in an <code>@EventPattern()</code> decorator. The <code>payload</code> is an event payload that we want to transmit to the remote microservice. This method returns a <strong>hot <code>Observable</code></strong> (unlike the cold <code>Observable</code> returned by <code>send()</code>), which means that whether or not you explicitly subscribe to the observable, the proxy will immediately try to deliver the event.</p>\n<p><app-banner-shop></app-banner-shop></p>\n<h4 appAnchor id=\"scopes\"><span>Scopes</span></h4>\n<p>For people coming from different programming language backgrounds, it might be unexpected to learn that in Nest, almost everything is shared across incoming requests. We have a connection pool to the database, singleton services with global state, etc. Remember that Node.js doesn&#39;t follow the request/response Multi-Threaded Stateless Model in which every request is processed by a separate thread. Hence, using singleton instances is fully <strong>safe</strong> for our applications.</p>\n<p>However, there are edge-cases when request-based lifetime of the handler may be the desired behavior, for instance per-request caching in GraphQL applications, request tracking or multi-tenancy. Learn how to control scopes <a routerLink=\"/fundamentals/injection-scopes\">here</a>.</p>\n<p>Request-scoped handlers and providers can inject <code>RequestContext</code> using the <code>@Inject()</code> decorator in combination with <code>CONTEXT</code> token:</p>\n<pre><code class=\"language-typescript\">\nimport &#123; Injectable, Scope, Inject &#125; from &#39;@nestjs/common&#39;;\nimport &#123; CONTEXT, RequestContext &#125; from &#39;@nestjs/microservices&#39;;\n\n@Injectable(&#123; scope: Scope.REQUEST &#125;)\nexport class CatsService &#123;\n  constructor(@Inject(CONTEXT) private readonly ctx: RequestContext) &#123;&#125;\n&#125;</code></pre>\n<p>This provides access to the <code>RequestContext</code> object, which has two properties:</p>\n<pre><code class=\"language-typescript\">\nexport interface RequestContext&lt;T = any&gt; &#123;\n  pattern: string | Record&lt;string, any&gt;;\n  data: T;\n&#125;</code></pre>\n<p>The <code>data</code> property is the message payload sent by the message producer. The <code>pattern</code> property is the pattern used to identify an appropriate handler to handle the incoming message.</p>\n\n</div>\n\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-custom-transport',\n  templateUrl: './custom-transport.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class CustomTransportComponent extends BasePageComponent {\n  get rabbitMqServer() {\n    return `\nimport * as amqp from 'amqplib';\nimport { Server, CustomTransportStrategy } from '@nestjs/microservices';\nimport { Observable } from 'rxjs';\n\nexport class RabbitMQServer extends Server implements CustomTransportStrategy {\n    private server: amqp.Connection = null;\n    private channel: amqp.Channel = null;\n\n    constructor(\n      private readonly host: string,\n      private readonly queue: string) {\n        super();\n      }\n\n  public async listen(callback: () => void) {\n    await this.init();\n    this.channel.consume(\\`\\${this.queue}_sub\\`, this.handleMessage.bind(this), {\n      noAck: true,\n    });\n  }\n\n  public close() {\n    this.channel && this.channel.close();\n    this.server && this.server.close();\n  }\n\n  private async handleMessage(message) {\n    const { content } = message;\n    const messageObj = JSON.parse(content.toString());\n\n    const handlers = this.getHandlers();\n    const pattern = JSON.stringify(messageObj.pattern);\n    if (!this.messageHandlers[pattern]) {\n        return;\n    }\n\n    const handler = this.messageHandlers[pattern];\n    const response$ = this.transformToObservable(await handler(messageObj.data)) as Observable<any>;\n    response$ && this.send(response$, (data) => this.sendMessage(data));\n  }\n\n  private sendMessage(message) {\n    const buffer = Buffer.from(JSON.stringify(message));\n    this.channel.sendToQueue(\\`\\${this.queue}_pub\\`, buffer);\n  }\n\n  private async init() {\n    this.server = await amqp.connect(this.host);\n    this.channel = await this.server.createChannel();\n    this.channel.assertQueue(\\`\\${this.queue}_sub\\`, { durable: false });\n    this.channel.assertQueue(\\`\\${this.queue}_pub\\`, { durable: false });\n  }\n}`;\n  }\n\n  get rabbitMqServerJs() {\n    return `\nimport * as amqp from 'amqplib';\nimport { Server } from '@nestjs/microservices';\nimport { Observable } from 'rxjs';\n\nexport class RabbitMQServer extends Server {\n    constructor(host, queue) {\n      super();\n\n      this.host = host;\n      this.queue = queue;\n      this.server = null;\n      this.channel = null;\n    }\n\n  async listen(callback) {\n    await this.init();\n    this.channel.consume(\\`\\${this.queue}_sub\\`, this.handleMessage.bind(this), {\n      noAck: true,\n    });\n  }\n\n  close() {\n    this.channel && this.channel.close();\n    this.server && this.server.close();\n  }\n\n  async handleMessage(message) {\n    const { content } = message;\n    const messageObj = JSON.parse(content.toString());\n\n    const handlers = this.getHandlers();\n    const pattern = JSON.stringify(messageObj.pattern);\n    if (!this.messageHandlers[pattern]) {\n        return;\n    }\n\n    const handler = this.messageHandlers[pattern];\n    const response$ = this.transformToObservable(await handler(messageObj.data));\n    response$ && this.send(response$, (data) => this.sendMessage(data));\n  }\n\n  sendMessage(message) {\n    const buffer = Buffer.from(JSON.stringify(message));\n    this.channel.sendToQueue(\\`\\${this.queue}_pub\\`, buffer);\n  }\n\n  async init() {\n    this.server = await amqp.connect(this.host);\n    this.channel = await this.server.createChannel();\n    this.channel.assertQueue(\\`\\${this.queue}_sub\\`, { durable: false });\n    this.channel.assertQueue(\\`\\${this.queue}_pub\\`, { durable: false });\n  }\n}`;\n  }\n\n  get setupServer() {\n    return `\nconst app = await NestFactory.createMicroservice(ApplicationModule, {\n    strategy: new RabbitMQServer('amqp://localhost', 'channel'),\n});`;\n  }\n\n  get rabbitMqClient() {\n    return `\nimport * as amqp from 'amqplib';\nimport { ClientProxy } from '@nestjs/microservices';\n\nexport class RabbitMQClient extends ClientProxy {\n  constructor(\n    private readonly host: string,\n    private readonly queue: string) {\n      super();\n    }\n\n  protected async sendSingleMessage(messageObj, callback: (err, result, disposed?: boolean) => void) {\n    const server = await amqp.connect(this.host);\n    const channel = await server.createChannel();\n\n    const { sub, pub } = this.getQueues();\n    channel.assertQueue(sub, { durable: false });\n    channel.assertQueue(pub, { durable: false });\n\n    channel.consume(pub, (message) => this.handleMessage(message, server, callback), { noAck: true });\n    channel.sendToQueue(sub, Buffer.from(JSON.stringify(messageObj)));\n  }\n\n  private handleMessage(message, server, callback: (err, result, disposed?: boolean) => void) {\n    const { content } = message;\n    const { err, response, disposed } = JSON.parse(content.toString());\n    if (disposed) {\n        server.close();\n    }\n    callback(err, response, disposed);\n  }\n\n  private getQueues() {\n    return { pub: \\`\\${this.queue}_pub\\`, sub: \\`\\${this.queue}_sub\\` };\n  }\n}`;\n  }\n\n  get rabbitMqClientJs() {\n    return `\nimport * as amqp from 'amqplib';\nimport { ClientProxy } from '@nestjs/microservices';\n\nexport class RabbitMQClient extends ClientProxy {\n  constructor(host, queue) {\n      super();\n\n      this.host = host;\n      this.queue = queue;\n    }\n\n  async sendSingleMessage(messageObj, callback) {\n    const server = await amqp.connect(this.host);\n    const channel = await server.createChannel();\n\n    const { sub, pub } = this.getQueues();\n    channel.assertQueue(sub, { durable: false });\n    channel.assertQueue(pub, { durable: false });\n\n    channel.consume(pub, (message) => this.handleMessage(message, server, callback), { noAck: true });\n    channel.sendToQueue(sub, Buffer.from(JSON.stringify(messageObj)));\n  }\n\n  handleMessage(message, server, callback) {\n    const { content } = message;\n    const { err, response, disposed } = JSON.parse(content.toString());\n    if (disposed) {\n        server.close();\n    }\n    callback(err, response, disposed);\n  }\n\n  getQueues() {\n    return { pub: \\`\\${this.queue}_pub\\`, sub: \\`\\${this.queue}_sub\\` };\n  }\n}`;\n  }\n\n  get rabbitMqClientNew() {\n    return `\nthis.client = new RabbitMQClient('amqp://localhost', 'example');`;\n  }\n}\n","<div class=\"content\">\n  <h3>Custom Transport</h3>\n  <p>\n    The Nest has a built-in transport via TCP and Redis, but other communication schemes can be implemented with <code>CustomTransportStrategy</code> interface.\n    For demonstration purposes, we're going to port the <a href=\"https://www.rabbitmq.com/\" target=\"_blank\" rel=\"nofollow\">RabbitMQ</a> transport strategy using <a href=\"https://github.com/squaremo/amqp.node\" rel=\"nofollow\" target=\"_blank\">ampqlib</a> library.\n  </p>\n  <h4>Server</h4>\n  <p>\n    Let's start from the <code>RabbitMQServer</code> which will match incoming messages to the right message handlers.\n  </p>\n  <span class=\"filename\">\n    {{ 'rabbitmq-server' | extension: rabbitMqServerT.isJsActive }}\n    <app-tabs #rabbitMqServerT></app-tabs>\n  </span>\n  <pre [class.hide]=\"rabbitMqServerT.isJsActive\"><code class=\"language-typescript\">{{ rabbitMqServer }}</code></pre>\n  <pre [class.hide]=\"!rabbitMqServerT.isJsActive\"><code class=\"language-typescript\">{{ rabbitMqServerJs }}</code></pre>\n  <p>\n    The <code>CustomTransportStrategy</code> forces to implement two fundamental methods - <code>listen()</code> and <code>close()</code>.\n    Moreover, the <code>RabbitMQServer</code> shall extends the abstract <code>Server</code> class. This class supplies the core <code>getHandlers()</code> and <code>send()</code> methods, and helper <code>transformToObservable()</code> method.\n  </p>\n  <p>\n    The last step is to set up the <code>RabbitMQServer</code>:\n  </p>\n  <span class=\"filename\">\n    {{ 'main' | extension: setupServerT.isJsActive }}\n    <app-tabs #setupServerT></app-tabs>\n  </span>\n  <pre><code class=\"language-typescript\">{{ setupServer }}</code></pre>\n  <h4>Client</h4>\n  <p>\n    The <a href=\"https://www.rabbitmq.com/\" target=\"_blank\" rel=\"nofollow\">RabbitMQ</a> server's listening to messages.\n    Now it's time to create a client class, which shall extends the abstract <code>ClientProxy</code> class.\n    To make it work, we only have to override <code>sendSingleMessage()</code> method.\n  </p>\n  <span class=\"filename\">\n    {{ 'rabbitmq-client' | extension: rabbitMqClientT.isJsActive }}\n    <app-tabs #rabbitMqClientT></app-tabs>\n  </span>\n  <pre [class.hide]=\"rabbitMqClientT.isJsActive\"><code class=\"language-typescript\">{{ rabbitMqClient }}</code></pre>\n  <pre [class.hide]=\"!rabbitMqClientT.isJsActive\"><code class=\"language-typescript\">{{ rabbitMqClientJs }}</code></pre>\n  <p>\n    Earlier, the Nest was responsible for creating the instance of the client class. We've been using the <code>@Client()</code> decorator.\n    Now, when we've created our own solution, we can just create the <code>RabbitMQClient</code> instance directly, using <code>new</code> operator.\n  </p>\n  <pre><code class=\"language-typescript\">{{ rabbitMqClientNew }}</code></pre>\n  <blockquote class=\"warning\">\n      <strong>Hint</strong> To make unit testing easy, you can provide a <a routerLink=\"/fundamentals/dependency-injection\">custom component</a> instead of creating the instance directly in the class body.\n   </blockquote>\n</div>\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-exception-filters',\n  templateUrl: './exception-filters.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class MicroservicesExceptionFiltersComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/exception-filters.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"exception-filters\">Exception filters</h3>\n<p>The only difference between the HTTP <a routerLink=\"/exception-filters\">exception filter</a> layer and the corresponding microservices layer is that instead of throwing <code>HttpException</code>, you should use <code>RpcException</code>.</p>\n<pre><code class=\"language-typescript\">\nthrow new RpcException(&#39;Invalid credentials.&#39;);</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>RpcException</code> class is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<p>With the sample above, Nest will handle the thrown exception and return the <code>error</code> object with the following structure:</p>\n<pre><code class=\"language-json\">\n&#123;\n  &quot;status&quot;: &quot;error&quot;,\n  &quot;message&quot;: &quot;Invalid credentials.&quot;\n&#125;</code></pre>\n<h4 appAnchor id=\"filters\"><span>Filters</span></h4>\n<p>Microservice exception filters behave similarly to HTTP exception filters, with one small difference. The <code>catch()</code> method must return an <code>Observable</code>.</p>\n\n<span class=\"filename\">\n  {{ 'rpc-exception.filter' | extension: appaf77c2dd20129ad4becc57d7da657de7ec7786b0.isJsActive }}\n<app-tabs #appaf77c2dd20129ad4becc57d7da657de7ec7786b0></app-tabs>\n</span><pre [class.hide]=\"appaf77c2dd20129ad4becc57d7da657de7ec7786b0.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Catch, RpcExceptionFilter, ArgumentsHost &#125; from &#39;@nestjs/common&#39;;\nimport &#123; Observable, throwError &#125; from &#39;rxjs&#39;;\nimport &#123; RpcException &#125; from &#39;@nestjs/microservices&#39;;\n\n@Catch(RpcException)\nexport class ExceptionFilter implements RpcExceptionFilter&lt;RpcException&gt; &#123;\n  catch(exception: RpcException, host: ArgumentsHost): Observable&lt;any&gt; &#123;\n    return throwError(exception.getError());\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appaf77c2dd20129ad4becc57d7da657de7ec7786b0.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Catch &#125; from &#39;@nestjs/common&#39;;\nimport &#123; throwError &#125; from &#39;rxjs&#39;;\n\n@Catch(RpcException)\nexport class ExceptionFilter &#123;\n  catch(exception, host) &#123;\n    return throwError(exception.getError());\n  &#125;\n&#125;</code></pre><blockquote class=\"\n\"><strong>Warning</strong> You cannot set up global microservice exception filters when using a <a routerLink=\"/faq/hybrid-application\">hybrid application</a>.\n</blockquote>\n<p>The following example uses a manually instantiated method-scoped filter. Just as with HTTP based applications, you can also use controller-scoped filters (i.e., prefix the controller class with a <code>@UseFilters()</code> decorator).</p>\n\n<span class=\"filename\">\n<app-tabs #appb2707abbd77e2a273451f02fca88d18976070fb5></app-tabs>\n</span><pre [class.hide]=\"appb2707abbd77e2a273451f02fca88d18976070fb5.isJsActive\"><code class=\"language-typescript\">\n@UseFilters(new ExceptionFilter())\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data: number[]): number &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre>\n<pre [class.hide]=\"!appb2707abbd77e2a273451f02fca88d18976070fb5.isJsActive\"><code class=\"language-typescript\">\n@UseFilters(new ExceptionFilter())\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data) &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre><h4 appAnchor id=\"inheritance\"><span>Inheritance</span></h4>\n<p>Typically, you&#39;ll create fully customized exception filters crafted to fulfill your application requirements. However, there might be use-cases when you would like to simply extend the <strong>core exception filter</strong>, and override the behavior based on certain factors.</p>\n<p>In order to delegate exception processing to the base filter, you need to extend <code>BaseExceptionFilter</code> and call the inherited <code>catch()</code> method.</p>\n\n<span class=\"filename\">\n<app-tabs #app5310164009d0c1987f39bb393bf57cddb02e6d85></app-tabs>\n</span><pre [class.hide]=\"app5310164009d0c1987f39bb393bf57cddb02e6d85.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Catch, ArgumentsHost &#125; from &#39;@nestjs/common&#39;;\nimport &#123; BaseRpcExceptionFilter &#125; from &#39;@nestjs/microservices&#39;;\n\n@Catch()\nexport class AllExceptionsFilter extends BaseRpcExceptionFilter &#123;\n  catch(exception: any, host: ArgumentsHost) &#123;\n    return super.catch(exception, host);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app5310164009d0c1987f39bb393bf57cddb02e6d85.isJsActive\"><code class=\"language-typescript\">\nimport &#123; Catch &#125; from &#39;@nestjs/common&#39;;\nimport &#123; BaseRpcExceptionFilter &#125; from &#39;@nestjs/microservices&#39;;\n\n@Catch()\nexport class AllExceptionsFilter extends BaseRpcExceptionFilter &#123;\n  catch(exception, host) &#123;\n    return super.catch(exception, host);\n  &#125;\n&#125;</code></pre><p>The above implementation is just a shell demonstrating the approach. Your implementation of the extended exception filter would include your tailored <strong>business logic</strong> (e.g., handling various conditions).</p>\n\n</div>\n\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-grpc',\n  templateUrl: './grpc.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class GrpcComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/grpc.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"grpc\">gRPC</h3>\n<p><a rel='nofollow' target='_blank' href=\"https://github.com/grpc/grpc-node\">gRPC</a> is a modern, open source, high performance RPC framework that can run in any environment. It can efficiently connect services in and across data centers with pluggable support for load balancing, tracing, health checking and authentication.</p>\n<p>Like many RPC systems, gRPC is based on the concept of defining a service in terms of functions (methods) that can be called remotely. For each method, you define the parameters and return types. Services, parameters, and return types are defined in <code>.proto</code> files using Google&#39;s open source language-neutral <a href=\"https://developers.google.com/protocol-buffers\">protocol buffers</a> mechanism.</p>\n<p>With the gRPC transporter, Nest uses <code>.proto</code> files to dynamically bind clients and servers to make it easy to implement remote procedure calls, automatically serializing and deserializing structured data.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To start building gRPC-based microservices, first install the required packages:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save grpc @grpc/proto-loader</code></pre>\n<h4 appAnchor id=\"overview\"><span>Overview</span></h4>\n<p>Like other Nest microservices transport layer implementations, you select the gRPC transporter mechanism using the <code>transport</code> property of the options object passed to the <code>createMicroservice()</code> method. In the following example, we&#39;ll set up a hero service. The <code>options</code> property provides metadata about that service; its properties are described <a href=\"microservices/grpc#options\">below</a>.</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app46aa2637a854346ebf6b1c0fad2aebd1444b1bca.isJsActive }}\n<app-tabs #app46aa2637a854346ebf6b1c0fad2aebd1444b1bca></app-tabs>\n</span><pre><code class=\"language-typescript\">\nconst app = await NestFactory.createMicroservice(AppModule, &#123;\n  transport: Transport.GRPC,\n  options: &#123;\n    package: &#39;hero&#39;,\n    protoPath: join(__dirname, &#39;hero/hero.proto&#39;),\n  &#125;,\n&#125;);</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>join()</code> function is imported from the <code>path</code> package; the <code>Transport</code> enum is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<h4 appAnchor id=\"options\"><span>Options</span></h4>\n<p>The <strong>gRPC</strong> transporter options object exposes the properties described below.</p>\n<table>\n  <tr>\n    <td><code>package</code></td>\n    <td>Protobuf package name (matches <code>package</code> setting from <code>.proto</code> file).  Required</td>\n  </tr>\n  <tr>\n    <td><code>protoPath</code></td>\n    <td>\n      Absolute (or relative to the root dir) path to the\n      <code>.proto</code> file. Required\n    </td>\n  </tr>\n  <tr>\n    <td><code>url</code></td>\n    <td>Connection url.  String in the format <code>ip address/dns name:port</code> (for example, <code>'localhost:50051'</code>) defining the address/port on which the transporter establishes a connection.  Optional.  Defaults to <code>'localhost:5000'</code></td>\n  </tr>\n  <tr>\n    <td><code>protoLoader</code></td>\n    <td>NPM package name for the utility to load <code>.proto</code> files.  Optional.  Defaults to <code>'@grpc/proto-loader'</code></td>\n  </tr>\n  <tr>\n    <td><code>loader</code></td>\n    <td>\n      <code>@grpc/proto-loader</code> options. These provide detailed control over the behavior of <code>.proto</code> files. Optional. See\n      <a\n        href=\"https://github.com/grpc/grpc-node/blob/master/packages/proto-loader/README.md\"\n        rel=\"nofollow\"\n        target=\"_blank\"\n        >here</a\n      > for more details\n    </td>\n  </tr>\n  <tr>\n    <td><code>credentials</code></td>\n    <td>\n      Server credentials.  Optional. <a\n        href=\"https://grpc.io/grpc/node/grpc.ServerCredentials.html\"\n        rel=\"nofollow\"\n        target=\"_blank\"\n        >Read more here</a\n      >\n    </td>\n  </tr>\n</table>\n\n<h4 appAnchor id=\"sample-grpc-service\"><span>Sample gRPC service</span></h4>\n<p>Let&#39;s define our sample gRPC service called <code>HeroService</code>. In the above <code>options</code> object, the<code>protoPath</code> property sets a path to the <code>.proto</code> definitions file <code>hero.proto</code>. The <code>hero.proto</code> file is structured using <a href=\"https://developers.google.com/protocol-buffers\">protocol buffers</a>. Here&#39;s what it looks like:</p>\n<pre><code class=\"language-typescript\">\n// hero/hero.proto\nsyntax = &quot;proto3&quot;;\n\npackage hero;\n\nservice HeroService &#123;\n  rpc FindOne (HeroById) returns (Hero) &#123;&#125;\n&#125;\n\nmessage HeroById &#123;\n  int32 id = 1;\n&#125;\n\nmessage Hero &#123;\n  int32 id = 1;\n  string name = 2;\n&#125;</code></pre>\n<p>Our <code>HeroService</code> exposes a <code>FindOne()</code> method. This method expects an input argument of type <code>HeroById</code> and returns a <code>Hero</code> message (protocol buffers use <code>message</code> elements to define both parameter types and return types).</p>\n<p>Next, we need to implement the service. To define a handler that fulfills this definition, we use the <code>@GrpcMethod()</code> decorator in a controller, as shown below. This decorator provides the metadata needed to declare a method as a gRPC service method.</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>@MessagePattern()</code> decorator (<a href=\"microservices/basics#request-response\">read more</a>) introduced in previous microservices chapters is not used with gRPC-based microservices. The <code>@GrpcMethod()</code> decorator effectively takes its place for gRPC-based microservices.\n</blockquote>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: app58383c95148359f60b7793d3e2b63383d317b9dc.isJsActive }}\n<app-tabs #app58383c95148359f60b7793d3e2b63383d317b9dc></app-tabs>\n</span><pre [class.hide]=\"app58383c95148359f60b7793d3e2b63383d317b9dc.isJsActive\"><code class=\"language-typescript\">\n@Controller()\nexport class HeroController &#123;\n  @GrpcMethod(&#39;HeroService&#39;, &#39;FindOne&#39;)\n  findOne(data: HeroById, metadata: any): Hero &#123;\n    const items = [\n      &#123; id: 1, name: &#39;John&#39; &#125;,\n      &#123; id: 2, name: &#39;Doe&#39; &#125;,\n    ];\n    return items.find((&#123; id &#125;) =&gt; id === data.id);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app58383c95148359f60b7793d3e2b63383d317b9dc.isJsActive\"><code class=\"language-typescript\">\n@Controller()\nexport class HeroController &#123;\n  @GrpcMethod(&#39;HeroService&#39;, &#39;FindOne&#39;)\n  findOne(data, metadata) &#123;\n    const items = [\n      &#123; id: 1, name: &#39;John&#39; &#125;,\n      &#123; id: 2, name: &#39;Doe&#39; &#125;,\n    ];\n    return items.find((&#123; id &#125;) =&gt; id === data.id);\n  &#125;\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>@GrpcMethod()</code> decorator is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<p>The decorator shown above takes two arguments. The first is the service name (e.g., <code>&#39;HeroService&#39;</code>), corresponding to the <code>HeroService</code> service definition in <code>hero.proto</code>. The second (the string <code>&#39;FindOne&#39;</code>) corresponds to the <code>FindOne()</code> rpc method defined within <code>HeroService</code> in the <code>hero.proto</code> file.</p>\n<p>The <code>findOne()</code> handler method takes two arguments, the <code>data</code> passed from the caller and <code>metadata</code> that stores gRPC request metadata.</p>\n<p>Both <code>@GrpcMethod()</code> decorator arguments are optional. If called without the second argument (e.g., <code>&#39;FindOne&#39;</code>), Nest will automatically associate the <code>.proto</code> file rpc method with the handler based on converting the handler name to upper camel case (e.g., the <code>findOne</code> handler is associated with the <code>FindOne</code> rpc call definition). This is shown below.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: app2e8d1cc587913cde273ff9d8b43899d9328fdd20.isJsActive }}\n<app-tabs #app2e8d1cc587913cde273ff9d8b43899d9328fdd20></app-tabs>\n</span><pre [class.hide]=\"app2e8d1cc587913cde273ff9d8b43899d9328fdd20.isJsActive\"><code class=\"language-typescript\">\n@Controller()\nexport class HeroController &#123;\n  @GrpcMethod(&#39;HeroService&#39;)\n  findOne(data: HeroById, metadata: any): Hero &#123;\n    const items = [\n      &#123; id: 1, name: &#39;John&#39; &#125;,\n      &#123; id: 2, name: &#39;Doe&#39; &#125;,\n    ];\n    return items.find((&#123; id &#125;) =&gt; id === data.id);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!app2e8d1cc587913cde273ff9d8b43899d9328fdd20.isJsActive\"><code class=\"language-typescript\">\n@Controller()\nexport class HeroController &#123;\n  @GrpcMethod(&#39;HeroService&#39;)\n  findOne(data, metadata) &#123;\n    const items = [\n      &#123; id: 1, name: &#39;John&#39; &#125;,\n      &#123; id: 2, name: &#39;Doe&#39; &#125;,\n    ];\n    return items.find((&#123; id &#125;) =&gt; id === data.id);\n  &#125;\n&#125;</code></pre><p>You can also omit the first <code>@GrpcMethod()</code> argument. In this case, Nest automatically associates the handler with the service definition from the proto definitions file based on the <strong>class</strong> name where the handler is defined. For example, in the following code, class <code>HeroService</code> associates its handler methods with the <code>HeroService</code> service definition in the <code>hero.proto</code> file based on the matching of the name <code>&#39;HeroService&#39;</code>.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: appc0e8bdc15fd1835784e0cec83aa526147f6a3f0f.isJsActive }}\n<app-tabs #appc0e8bdc15fd1835784e0cec83aa526147f6a3f0f></app-tabs>\n</span><pre [class.hide]=\"appc0e8bdc15fd1835784e0cec83aa526147f6a3f0f.isJsActive\"><code class=\"language-typescript\">\n@Controller()\nexport class HeroService &#123;\n  @GrpcMethod()\n  findOne(data: HeroById, metadata: any): Hero &#123;\n    const items = [\n      &#123; id: 1, name: &#39;John&#39; &#125;,\n      &#123; id: 2, name: &#39;Doe&#39; &#125;,\n    ];\n    return items.find((&#123; id &#125;) =&gt; id === data.id);\n  &#125;\n&#125;</code></pre>\n<pre [class.hide]=\"!appc0e8bdc15fd1835784e0cec83aa526147f6a3f0f.isJsActive\"><code class=\"language-typescript\">\n@Controller()\nexport class HeroService &#123;\n  @GrpcMethod()\n  findOne(data, metadata) &#123;\n    const items = [\n      &#123; id: 1, name: &#39;John&#39; &#125;,\n      &#123; id: 2, name: &#39;Doe&#39; &#125;,\n    ];\n    return items.find((&#123; id &#125;) =&gt; id === data.id);\n  &#125;\n&#125;</code></pre><h4 appAnchor id=\"client\"><span>Client</span></h4>\n<p>Nest applications can act as gRPC clients, consuming services defined in <code>.proto</code> files. You access remote services through a <code>ClientGrpc</code> object. You can obtain a <code>ClientGrpc</code> object in several ways.</p>\n<p>The preferred technique is to import the <code>ClientsModule</code>. Use the <code>register()</code> method to bind a package of services defined in a <code>.proto</code> file to an injection token, and to configure the service. The <code>name</code> property is the injection token. For gRPC services, use <code>transport: Transport.GRPC</code>. The <code>options</code> property is an object with the same properties described <a href=\"microservices/grpc#options\">above</a>.</p>\n<pre><code class=\"language-typescript\">\nimports: [\n  ClientsModule.register([\n    &#123;\n      name: &#39;HERO_PACKAGE&#39;,\n      transport: Transport.GRPC,\n      options: &#123;\n        package: &#39;hero&#39;,\n        protoPath: join(__dirname, &#39;hero/hero.proto&#39;),\n      &#125;,\n    &#125;,\n  ]),\n];</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>register()</code> method takes an array of objects. Register multiple packages by providing a comma separated list of registration objects.\n</blockquote>\n<p>Once registered, we can inject the configured <code>ClientGrpc</code> object with <code>@Inject()</code>. Then we use the <code>ClientGrpc</code> object&#39;s <code>getService()</code> method to retrieve the service instance, as shown below.</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nexport class AppService implements OnModuleInit &#123;\n  private heroService: HeroService;\n\n  constructor(@Inject(&#39;HERO_PACKAGE&#39;) private readonly client: ClientGrpc) &#123;&#125;\n\n  onModuleInit() &#123;\n    this.heroService = this.client.getService&lt;HeroService&gt;(&#39;HeroService&#39;);\n  &#125;\n\n  getHero(): Observable&lt;string&gt; &#123;\n    return this.heroService.findOne(&#123; id: 1 &#125;);\n  &#125;\n&#125;</code></pre>\n<p>Notice that there is a small difference compared to the technique used in other microservice transport methods. Instead of the <code>ClientProxy</code> class, we use the <code>ClientGrpc</code> class, which provides the <code>getService()</code> method. The <code>getService()</code> generic method takes a service name as an argument and returns its instance (if available).</p>\n<p>Alternatively, you can use the <code>@Client()</code> decorator to instantiate a <code>ClientGrpc</code> object, as follows:</p>\n<pre><code class=\"language-typescript\">\n@Injectable()\nexport class AppService implements OnModuleInit &#123;\n  @Client(&#123;\n    transport: Transport.GRPC,\n    options: &#123;\n      package: &#39;hero&#39;,\n      protoPath: join(__dirname, &#39;hero/hero.proto&#39;),\n    &#125;,\n  &#125;)\n  client: ClientGrpc;\n\n  private heroService: HeroService;\n\n  onModuleInit() &#123;\n    this.heroService = this.client.getService&lt;HeroService&gt;(&#39;HeroService&#39;);\n  &#125;\n\n  getHero(): Observable&lt;string&gt; &#123;\n    return this.heroService.findOne(&#123; id: 1 &#125;);\n  &#125;\n&#125;</code></pre>\n<p>Finally, for more complex scenarios, we can inject a dynamically configured client using the <code>ClientProxyFactory</code> class as described <a href=\"/microservices/basics#client\">here</a>.</p>\n<p>In either case, we end up with a reference to our <code>HeroService</code> proxy object, which exposes the same set of methods that are defined inside the <code>.proto</code> file. Now, when we access this proxy object (i.e., <code>heroService</code>), the gRPC system automatically serializes requests, forwards them to the remote system, returns a response, and deserializes the response. Because gRPC shields us from these network communication details, <code>heroService</code> looks and acts like a local provider.</p>\n<p>Note, all service methods are <strong>lower camel cased</strong> (in order to follow the natural convention of the language). So, for example, while our <code>.proto</code> file <code>HeroService</code> definition contains the <code>FindOne()</code> function, the <code>heroService</code> instance will provide the <code>findOne()</code> method.</p>\n<pre><code class=\"language-typescript\">\ninterface HeroService &#123;\n  findOne(data: &#123; id: number &#125;): Observable&lt;any&gt;;\n&#125;</code></pre>\n<p>A message handler is also able to return an <code>Observable</code>, in which case the result values will be emitted until the stream is completed.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: app02c6b8e8c207f3cf41ab906ed49cfe4b953aff7a.isJsActive }}\n<app-tabs #app02c6b8e8c207f3cf41ab906ed49cfe4b953aff7a></app-tabs>\n</span><pre [class.hide]=\"app02c6b8e8c207f3cf41ab906ed49cfe4b953aff7a.isJsActive\"><code class=\"language-typescript\">\n@Get()\ncall(): Observable&lt;any&gt; &#123;\n  return this.heroService.findOne(&#123; id: 1 &#125;);\n&#125;</code></pre>\n<pre [class.hide]=\"!app02c6b8e8c207f3cf41ab906ed49cfe4b953aff7a.isJsActive\"><code class=\"language-typescript\">\n@Get()\ncall() &#123;\n  return this.heroService.findOne(&#123; id: 1 &#125;);\n&#125;</code></pre><p>A full working example is available <a rel='nofollow' target='_blank' href=\"https://github.com/nestjs/nest/tree/master/sample/04-grpc\">here</a>.</p>\n<h4 appAnchor id=\"grpc-streaming\"><span>gRPC Streaming</span></h4>\n<p>gRPC on its own supports long-term live connections, conventionally known as <code>streams</code>. Streams are useful for cases such as Chatting, Observations or Chunk-data transfers. Find more details in the official documentation <a rel='nofollow' target='_blank' href=\"https://grpc.io/docs/guides/concepts/\">here</a>.</p>\n<p>Nest supports GRPC stream handlers in two possible ways:</p>\n<ul>\n<li>RxJS <code>Subject</code> + <code>Observable</code> handler: can be useful to write responses right inside of a Controller method or to be passed down to <code>Subject</code>/<code>Observable</code> consumer</li>\n<li>Pure GRPC call stream handler: can be useful to be passed to some executor which will handle the rest of dispatch for the Node standard <code>Duplex</code> stream handler.</li>\n</ul>\n<p><app-banner-enterprise></app-banner-enterprise></p>\n<h4 appAnchor id=\"streaming-sample\"><span>Streaming sample</span></h4>\n<p>Let&#39;s define a new sample gRPC service called <code>HelloService</code>. The <code>hello.proto</code> file is structured using <a href=\"https://developers.google.com/protocol-buffers\">protocol buffers</a>. Here&#39;s what it looks like:</p>\n<pre><code class=\"language-typescript\">\n// hello/hello.proto\nsyntax = &quot;proto3&quot;;\n\npackage hello;\n\nservice HelloService &#123;\n  rpc BidiHello(stream HelloRequest) returns (stream HelloResponse)\n  rpc LotsOfGreetings(stream HelloRequest) returns (HelloResponse)\n&#125;\n\nmessage HelloRequest &#123;\n  string greeting = 1;\n&#125;\n\nmessage HelloResponse &#123;\n  string reply = 1;\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>LotsOfGreetings</code> method can be simply implemented with the <code>@GrpcMethod</code> decorator (as in the examples above) since the returned stream can emit multiple values.\n</blockquote>\n<p>Based on this <code>.proto</code> file, let&#39;s define the <code>HelloService</code> interface:</p>\n<pre><code class=\"language-typescript\">\ninterface HelloService &#123;\n  bidiHello(upstream: Observable&lt;HelloRequest&gt;): Observable&lt;HelloResponse&gt;;\n  lotsOfGreetings(\n    upstream: Observable&lt;HelloRequest&gt;,\n  ): Observable&lt;HelloResponse&gt;;\n&#125;\n\ninterface HelloRequest &#123;\n  greeting: string;\n&#125;\n\ninterface HelloResponse &#123;\n  reply: string;\n&#125;</code></pre>\n<h4 appAnchor id=\"subject-strategy\"><span>Subject strategy</span></h4>\n<p>The <code>@GrpcStreamMethod()</code> decorator provides the function parameter as an RxJS <code>Observable</code>. Thus, we can receive and process multiple messages.</p>\n<pre><code class=\"language-typescript\">\n@GrpcStreamMethod()\nbidiHello(messages: Observable&lt;any&gt;): Observable&lt;any&gt; &#123;\n  const subject = new Subject();\n\n  const onNext = message =&gt; &#123;\n    console.log(message);\n    subject.next(&#123;\n      reply: &#39;Hello, world!&#39;\n    &#125;);\n  &#125;;\n  const onComplete = () =&gt; subject.complete();\n  messages.subscribe(onNext, null, onComplete);\n\n  return subject.asObservable();\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> For supporting full-duplex interaction with the <code>@GrpcStreamMethod()</code> decorator, the controller method must return an RxJS <code>Observable</code>.\n</blockquote>\n<p>According to the service definition (in the <code>.proto</code> file), the <code>BidiHello</code> method should stream requests to the service. To send multiple asynchronous messages to the stream from a client, we leverage an RxJS <code>ReplySubject</code> class.</p>\n<pre><code class=\"language-typescript\">\nconst helloService = this.client.getService&lt;HelloService&gt;(&#39;HelloService&#39;);\nconst helloRequest$ = new ReplySubject&lt;HelloRequest&gt;();\n\nhelloRequest$.next(&#123; greeting: &#39;Hello (1)!&#39; &#125;);\nhelloRequest$.next(&#123; greeting: &#39;Hello (2)!&#39; &#125;);\nhelloRequest$.complete();\n\nreturn helloService.bidiHello(helloRequest$);</code></pre>\n<p>In the example above, we wrote two messages to the stream (<code>next()</code> calls) and notified the service that we&#39;ve completed sending the data (<code>complete()</code> call).</p>\n<h4 appAnchor id=\"call-stream-handler\"><span>Call stream handler</span></h4>\n<p>When the method return value is defined as <code>stream</code>, the <code>@GrpcStreamCall()</code> decorator provides the function parameter as <code>grpc.ServerDuplexStream</code>, which supports standard methods like <code>.on(&#39;data&#39;, callback)</code>, <code>.write(message)</code> or <code>.cancel()</code>. Full documentation on available methods can be found <a rel='nofollow' target='_blank' href=\"https://grpc.github.io/grpc/node/grpc-ClientDuplexStream.html\">here</a>.</p>\n<p>Alternatively, when the method return value is not a <code>stream</code>, the <code>@GrpcStreamCall()</code> decorator provides two function parameters, respectively <code>grpc.ServerReadableStream</code> (read more <a rel='nofollow' target='_blank' href=\"https://grpc.github.io/grpc/node/grpc-ServerReadableStream.html\">here</a>) and <code>callback</code>.</p>\n<p>Let&#39;s start with implementing the <code>BidiHello</code> which should support a full-duplex interaction.</p>\n<pre><code class=\"language-typescript\">\n@GrpcStreamCall()\nbidiHello(requestStream: any) &#123;\n  requestStream.on(&#39;data&#39;, message =&gt; &#123;\n    console.log(message);\n    requestStream.write(&#123;\n      reply: &#39;Hello, world!&#39;\n    &#125;);\n  &#125;);\n&#125;</code></pre>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> This decorator does not require any specific return parameter to be provided. It is expected that the stream will be handled similar to any other standard stream type.\n</blockquote>\n<p>In the example above, we used the <code>write()</code> method to write objects to the response stream. The callback passed into the <code>.on()</code> method as a second parameter will be called every time our service receives a new chunk of data.</p>\n<p>Let&#39;s implement the <code>LotsOfGreetings</code> method.</p>\n<pre><code class=\"language-typescript\">\n@GrpcStreamCall()\nlotsOfGreetings(requestStream: any, callback: (err: unknown, value: HelloResponse) =&gt; void) &#123;\n  requestStream.on(&#39;data&#39;, message =&gt; &#123;\n    console.log(message);\n  &#125;);\n  requestStream.on(&#39;end&#39;, () =&gt; callback(null, &#123; reply: &#39;Hello, world!&#39; &#125;));\n&#125;</code></pre>\n<p>Here we used the <code>callback</code> function to send the response once processing of the <code>requestStream</code> has been completed.</p>\n\n</div>\n\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-guards',\n  templateUrl: './guards.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class MicroservicesGuardsComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/guards.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"guards\">Guards</h3>\n<p>There is no fundamental difference between microservices guards and <a routerLink=\"/guards\">regular HTTP application guards</a>.\nThe only difference is that instead of throwing <code>HttpException</code>, you should use <code>RpcException</code>.</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>RpcException</code> class is exposed from <code>@nestjs/microservices</code> package.\n</blockquote>\n<h4 appAnchor id=\"binding-guards\"><span>Binding guards</span></h4>\n<p>The following example uses a method-scoped guard. Just as with HTTP based applications, you can also use controller-scoped guards (i.e., prefix the controller class with a <code>@UseGuards()</code> decorator).</p>\n\n<span class=\"filename\">\n<app-tabs #app979e9b9dfc05bdb0535cffdee9d1ec230062f6bb></app-tabs>\n</span><pre [class.hide]=\"app979e9b9dfc05bdb0535cffdee9d1ec230062f6bb.isJsActive\"><code class=\"language-typescript\">\n@UseGuards(AuthGuard)\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data: number[]): number &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre>\n<pre [class.hide]=\"!app979e9b9dfc05bdb0535cffdee9d1ec230062f6bb.isJsActive\"><code class=\"language-typescript\">\n@UseGuards(AuthGuard)\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data) &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre>\n</div>\n\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-interceptors',\n  templateUrl: './interceptors.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class MicroservicesInterceptorsComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/interceptors.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"interceptors\">Interceptors</h3>\n<p>There is no difference between <a routerLink=\"/interceptors\">regular interceptors</a> and microservices interceptors. The following example uses a manually instantiated method-scoped interceptor. Just as with HTTP based applications, you can also use controller-scoped interceptors (i.e., prefix the controller class with a <code>@UseInterceptors()</code> decorator).</p>\n\n<span class=\"filename\">\n<app-tabs #app00f371b1832935d1e04b35e9466620e0cb876fe4></app-tabs>\n</span><pre [class.hide]=\"app00f371b1832935d1e04b35e9466620e0cb876fe4.isJsActive\"><code class=\"language-typescript\">\n@UseInterceptors(new TransformInterceptor())\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data: number[]): number &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre>\n<pre [class.hide]=\"!app00f371b1832935d1e04b35e9466620e0cb876fe4.isJsActive\"><code class=\"language-typescript\">\n@UseInterceptors(new TransformInterceptor())\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data) &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre>\n</div>\n\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-kafka',\n  templateUrl: './kafka.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class KafkaComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/kafka.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"kafka\">Kafka</h3>\n<p><a rel='nofollow' target='_blank' href=\"https://kafka.apache.org/\">Kafka</a> is an open source, distributed streaming platform which has three key capabilities:</p>\n<ul>\n<li>Publish and subscribe to streams of records, similar to a message queue or enterprise messaging system.</li>\n<li>Store streams of records in a fault-tolerant durable way.</li>\n<li>Process streams of records as they occur.</li>\n</ul>\n<p>The Kafka project aims to provide a unified, high-throughput, low-latency platform for handling real-time data feeds. It integrates very well with Apache Storm and Spark for real-time streaming data analysis.</p>\n<p><strong>Kafka transporter is experimental.</strong></p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To start building Kafka-based microservices, first install the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save kafkajs</code></pre>\n<h4 appAnchor id=\"overview\"><span>Overview</span></h4>\n<p>Like other Nest microservices transport layer implementations, you select the Kafka transporter mechanism using the <code>transport</code> property of the options object passed to the <code>createMicroservice()</code> method, along with an optional <code>options</code> property, as shown below:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app7371455fdce0e6e343e46b7dbdbe204edfd65550.isJsActive }}\n<app-tabs #app7371455fdce0e6e343e46b7dbdbe204edfd65550></app-tabs>\n</span><pre><code class=\"language-typescript\">\nconst app = await NestFactory.createMicroservice(ApplicationModule, &#123;\n  transport: Transport.KAFKA,\n  options: &#123;\n    client: &#123;\n      brokers: [&#39;localhost:9092&#39;],\n    &#125;\n  &#125;\n&#125;);</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>Transport</code> enum is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<h4 appAnchor id=\"options\"><span>Options</span></h4>\n<p>The <code>options</code> property is specific to the chosen transporter. The <strong>Kafka</strong> transporter exposes the properties described below.</p>\n<table>\n  <tr>\n    <td><code>client</code></td>\n    <td>Client configuration options (read more\n      <a\n        href=\"https://kafka.js.org/docs/configuration\"\n        rel=\"nofollow\"\n        target=\"blank\"\n        >here</a\n      >)</td>\n  </tr>\n  <tr>\n    <td><code>consumer</code></td>\n    <td>Consumer configuration options (read more\n      <a\n        href=\"https://kafka.js.org/docs/consuming#a-name-options-a-options\"\n        rel=\"nofollow\"\n        target=\"blank\"\n        >here</a\n      >)</td>\n  </tr>\n  <tr>\n    <td><code>run</code></td>\n    <td>Run configuration options (read more\n      <a\n        href=\"https://kafka.js.org/docs/consuming\"\n        rel=\"nofollow\"\n        target=\"blank\"\n        >here</a\n      >)</td>\n  </tr>\n  <tr>\n    <td><code>subscribe</code></td>\n    <td>Subscribe configuration options (read more\n      <a\n        href=\"https://kafka.js.org/docs/consuming#frombeginning\"\n        rel=\"nofollow\"\n        target=\"blank\"\n        >here</a\n      >)</td>\n  </tr>\n  <tr>\n    <td><code>producer</code></td>\n    <td>Producer configuration options (read more\n      <a\n        href=\"https://kafka.js.org/docs/producing#options\"\n        rel=\"nofollow\"\n        target=\"blank\"\n        >here</a\n      >)</td>\n  </tr>\n  <tr>\n    <td><code>send</code></td>\n    <td>Send configuration options (read more\n      <a\n        href=\"https://kafka.js.org/docs/producing#options\"\n        rel=\"nofollow\"\n        target=\"blank\"\n        >here</a\n      >)</td>\n  </tr>\n</table>\n\n<h4 appAnchor id=\"client\"><span>Client</span></h4>\n<p>There is a small difference in Kafka compared to other microservice transporters. Instead of the <code>ClientProxy</code> class, we use the <code>ClientKafka</code> class.</p>\n<p>Like other microservice transporters, you have <a href=\"https://docs.nestjs.com/microservices/basics#client\">several options</a> for creating a <code>ClientKafka</code> instance.</p>\n<p>One method for creating an instance is to use use the <code>ClientsModule</code>. To create a client instance with the <code>ClientsModule</code>, import it and use the <code>register()</code> method to pass an options object with the same properties shown above in the <code>createMicroservice()</code> method, as well as a <code>name</code> property to be used as the injection token. Read more about <code>ClientsModule</code> <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    ClientsModule.register([\n      &#123;\n        name: &#39;HERO_SERVICE&#39;,\n        transport: Transport.KAFKA,\n        options: &#123;\n          client: &#123;\n            clientId: &#39;hero&#39;,\n            brokers: [&#39;localhost:9092&#39;],\n          &#125;,\n          consumer: &#123;\n            groupId: &#39;hero-consumer&#39;\n          &#125;\n        &#125;\n      &#125;,\n    ]),\n  ]\n  ...\n&#125;)</code></pre>\n<p>Other options to create a client (either <code>ClientProxyFactory</code> or <code>@Client()</code>) can be used as well. You can read about them <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<p>Use the <code>@Client()</code> decorator as follows:</p>\n<pre><code class=\"language-typescript\">\n@Client(&#123;\n  transport: Transport.KAFKA,\n  options: &#123;\n    client: &#123;\n      clientId: &#39;hero&#39;,\n      brokers: [&#39;localhost:9092&#39;],\n    &#125;,\n    consumer: &#123;\n      groupId: &#39;hero-consumer&#39;\n    &#125;\n  &#125;\n&#125;)\nclient: ClientKafka;</code></pre>\n<h4 appAnchor id=\"message-response-subscription\"><span>Message response subscription</span></h4>\n<p>The <code>ClientKafka</code> class provides the <code>subscribeToResponseOf()</code> method. The <code>subscribeToResponseOf()</code> method takes a request&#39;s topic name as an argument and adds the derived reply topic name to a collection of reply topics. This method is required when implementing the message pattern.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: app3542c377bdb740f8014003555d218d614d6e11ea.isJsActive }}\n<app-tabs #app3542c377bdb740f8014003555d218d614d6e11ea></app-tabs>\n</span><pre><code class=\"language-typescript\">\nonModuleInit() &#123;\n  this.client.subscribeToResponseOf(&#39;hero.kill.dragon&#39;);\n&#125;</code></pre><p>If the <code>ClientKafka</code> instance is created asynchronously, the <code>subscribeToResponseOf()</code> method must be called before calling the <code>connect()</code> method.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: app81d29d6fc4408a33ffafa1cc30cf700b7938efdc.isJsActive }}\n<app-tabs #app81d29d6fc4408a33ffafa1cc30cf700b7938efdc></app-tabs>\n</span><pre><code class=\"language-typescript\">\nasync onModuleInit() &#123;\n  this.client.subscribeToResponseOf(&#39;hero.kill.dragon&#39;);\n  await this.client.connect();\n&#125;</code></pre><h4 appAnchor id=\"message-pattern\"><span>Message pattern</span></h4>\n<p>The Kafka microservice message pattern utilizes two topics for the request and reply channels. The <code>ClientKafka#send()</code> method sends messages with a <a rel='nofollow' target='_blank' href=\"https://www.enterpriseintegrationpatterns.com/patterns/messaging/ReturnAddress.html\">return address</a> by associating a <a rel='nofollow' target='_blank' href=\"https://www.enterpriseintegrationpatterns.com/patterns/messaging/CorrelationIdentifier.html\">correlation id</a>, reply topic, and reply partition with the request message. This requires the <code>ClientKafka</code> instance to be subscribed to the reply topic and assigned to at least one partition before sending a message.</p>\n<p>Subsequently, you need to have at least one reply topic partition for every Nest application running. For example, if you are running 4 Nest applications but the reply topic only has 3 partitions, then 1 of the Nest applications will error out when trying to send a message.</p>\n<p>When new <code>ClientKafka</code> instances are launched they join the consumer group and subscribe to their respective topics. This process triggers a rebalance of topic partitions assigned to consumers of the consumer group.</p>\n<p>Normally, topic partitions are assigned using the round robin partitioner, which assigns topic partitions to a collection of consumers sorted by consumer names which are randomly set on application launch. However, when a new consumer joins the consumer group, the new consumer can be positioned anywhere within the collection of consumers. This creates a condition where pre-existing consumers can be assigned different partitions when the pre-existing consumer is positioned after the new consumer. As a result, the consumers that are assigned different partitions will lose response messages of requests sent before the rebalance.</p>\n<p>To prevent the <code>ClientKafka</code> consumers from losing response messages, a Nest-specific built-in custom partitioner is utilized. This custom partitioner assigns partitions to a collection of consumers sorted by high-resolution timestamps (<code>process.hrtime()</code>) that are set on application launch.</p>\n<h4 appAnchor id=\"incoming\"><span>Incoming</span></h4>\n<p>Nest receives incoming Kafka messages as an object with <code>key</code>, <code>value</code>, and <code>headers</code> properties that have values of type <code>Buffer</code>. Nest then parses these values by transforming the buffers into strings. If the string is &quot;object like&quot;, Nest attempts to parse the string as <code>JSON</code>. The <code>value</code> is then passed to its associated handler.</p>\n<h4 appAnchor id=\"outgoing\"><span>Outgoing</span></h4>\n<p>Nest sends outgoing Kafka messages after a serialization process when publishing events or sending messages. This occurs on arguments passed to the <code>ClientKafka</code> <code>emit()</code> and <code>send()</code> methods or on values returned from a <code>@MessagePattern</code> method. This serialization &quot;stringifies&quot; objects that are not strings or buffers by using <code>JSON.stringify()</code> or the <code>toString()</code> prototype method.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: appcc9a740c48b073bfeb0abffb961a2fda394182d9.isJsActive }}\n<app-tabs #appcc9a740c48b073bfeb0abffb961a2fda394182d9></app-tabs>\n</span><pre><code class=\"language-typescript\">\n@Controller()\nexport class HeroController &#123;\n  @MessagePattern(&#39;hero.kill.dragon&#39;)\n  killDragon(@Payload() message: KillDragonMessage): any &#123;\n    const dragonId = message.dragonId;\n    const items = [\n      &#123; id: 1, name: &#39;Mythical Sword&#39; &#125;,\n      &#123; id: 2, name: &#39;Key to Dungeon&#39; &#125;,\n    ];\n    return items;\n  &#125;\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> <code>@Payload()</code> is imported from the <code>@nestjs/microservices</code>.\n</blockquote>\n<p>Outgoing messages can also be keyed by passing an object with the <code>key</code> and <code>value</code> properties. Keying messages is important for meeting the <a rel='nofollow' target='_blank' href=\"https://docs.confluent.io/current/ksql/docs/developer-guide/partition-data.html#co-partitioning-requirements\">co-partitioning requirement</a>.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: appb2548cf1e1f6dd3f440a8ed1c7fd3bcfec5e9e5d.isJsActive }}\n<app-tabs #appb2548cf1e1f6dd3f440a8ed1c7fd3bcfec5e9e5d></app-tabs>\n</span><pre><code class=\"language-typescript\">\n@Controller()\nexport class HeroController &#123;\n  @MessagePattern(&#39;hero.kill.dragon&#39;)\n  killDragon(@Payload() message: KillDragonMessage): any &#123;\n    const realm = &#39;Nest&#39;;\n    const heroId = message.heroId;\n    const dragonId = message.dragonId;\n\n    const items = [\n      &#123; id: 1, name: &#39;Mythical Sword&#39; &#125;,\n      &#123; id: 2, name: &#39;Key to Dungeon&#39; &#125;,\n    ];\n\n    return &#123;\n      headers: &#123;\n        realm\n      &#125;,\n      key: heroId,\n      value: items\n    &#125;\n  &#125;\n&#125;</code></pre><p>Additionally, messages passed in this format can also contain custom headers set in the <code>headers</code> hash property. Header hash property values must be either of type <code>string</code> or type <code>Buffer</code>.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: app1a2806c4e1fe0362e23db9479166a21db01ef388.isJsActive }}\n<app-tabs #app1a2806c4e1fe0362e23db9479166a21db01ef388></app-tabs>\n</span><pre><code class=\"language-typescript\">\n@Controller()\nexport class HeroController &#123;\n  @MessagePattern(&#39;hero.kill.dragon&#39;)\n  killDragon(@Payload() message: KillDragonMessage): any &#123;\n    const realm = &#39;Nest&#39;;\n    const heroId = message.heroId;\n    const dragonId = message.dragonId;\n\n    const items = [\n      &#123; id: 1, name: &#39;Mythical Sword&#39; &#125;,\n      &#123; id: 2, name: &#39;Key to Dungeon&#39; &#125;,\n    ];\n\n    return &#123;\n      headers: &#123;\n        kafka_nestRealm: realm\n      &#125;,\n      key: heroId,\n      value: items\n    &#125;\n  &#125;\n&#125;</code></pre><h4 appAnchor id=\"context\"><span>Context</span></h4>\n<p>In more sophisticated scenarios, you may want to access more information about the incoming request. When using the Kafka transporter, you can access the <code>KafkaContext</code> object.</p>\n\n<span class=\"filename\">\n<app-tabs #app75f741f011145eb2716e2daf3fe1d7ed1d7c2563></app-tabs>\n</span><pre [class.hide]=\"app75f741f011145eb2716e2daf3fe1d7ed1d7c2563.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;hero.kill.dragon&#39;)\nkillDragon(@Payload() message: KillDragonMessage, @Ctx() context: KafkaContext) &#123;\n  console.log(`Topic: $&#123;context.getTopic()&#125;`);\n&#125;</code></pre>\n<pre [class.hide]=\"!app75f741f011145eb2716e2daf3fe1d7ed1d7c2563.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;hero.kill.dragon&#39;)\nkillDragon(message, context) &#123;\n  console.log(`Topic: $&#123;context.getTopic()&#125;`);\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> <code>@Payload()</code>, <code>@Ctx()</code> and <code>KafkaContext</code> are imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<p>To access the original Kafka <code>IncomingMessage</code> object, use the <code>getMessage()</code> method of the <code>KafkaContext</code> object, as follows:</p>\n\n<span class=\"filename\">\n<app-tabs #app8bfa60cb015012fca30b57df0480ff1ffbd7d723></app-tabs>\n</span><pre [class.hide]=\"app8bfa60cb015012fca30b57df0480ff1ffbd7d723.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;hero.kill.dragon&#39;)\nkillDragon(@Payload() message: KillDragonMessage, @Ctx() context: KafkaContext) &#123;\n  const originalMessage = context.getMessage();\n  const &#123; headers, partition, timestamp &#125; = originalMessage;\n&#125;</code></pre>\n<pre [class.hide]=\"!app8bfa60cb015012fca30b57df0480ff1ffbd7d723.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;hero.kill.dragon&#39;)\nkillDragon(message, context) &#123;\n  const originalMessage = context.getMessage();\n  const &#123; headers, partition, timestamp &#125; = originalMessage;\n&#125;</code></pre><p>Where the <code>IncomingMessage</code> fulfills the following interface:</p>\n<pre><code class=\"language-typescript\">\ninterface IncomingMessage &#123;\n  topic: string;\n  partition: number;\n  timestamp: string;\n  size: number;\n  attributes: number;\n  offset: string;\n  key: any;\n  value: any;\n  headers: Record&lt;string, any&gt;;\n&#125;</code></pre>\n<h4 appAnchor id=\"naming-conventions\"><span>Naming conventions</span></h4>\n<p>The Kafka microservice components append a description of their respective role onto the <code>client.clientId</code> and <code>consumer.groupId</code> options to prevent collisions between Nest microservice client and server components. By default the <code>ClientKafka</code> components append <code>-client</code> and the <code>ServerKafka</code> components append <code>-server</code> to both of these options. Note how the provided values below are transformed in that way (as shown in the comments).</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app50739ee301d54746809e11d0888eb2a204461b1a.isJsActive }}\n<app-tabs #app50739ee301d54746809e11d0888eb2a204461b1a></app-tabs>\n</span><pre><code class=\"language-typescript\">\nconst app = await NestFactory.createMicroservice(ApplicationModule, &#123;\n  transport: Transport.KAFKA,\n  options: &#123;\n    client: &#123;\n      clientId: &#39;hero&#39;, // hero-server\n      brokers: [&#39;localhost:9092&#39;],\n    &#125;,\n    consumer: &#123;\n      groupId: &#39;hero-consumer&#39; // hero-consumer-server\n    &#125;,\n  &#125;\n&#125;);</code></pre><p>And for the client:</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: app5bdce67b25853f69a375d5d6637995d830a98e65.isJsActive }}\n<app-tabs #app5bdce67b25853f69a375d5d6637995d830a98e65></app-tabs>\n</span><pre><code class=\"language-typescript\">\n@Client(&#123;\n  transport: Transport.KAFKA,\n  options: &#123;\n    client: &#123;\n      clientId: &#39;hero&#39;, // hero-client\n      brokers: [&#39;localhost:9092&#39;],\n    &#125;,\n    consumer: &#123;\n      groupId: &#39;hero-consumer&#39; // hero-consumer-client\n    &#125;\n  &#125;\n&#125;)\nclient: ClientKafka;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> Kafka client and consumer naming conventions can be customized by extending <code>ClientKafka</code> and <code>KafkaServer</code> in your own custom provider and overriding the constructor.\n</blockquote>\n<p>Since the Kafka microservice message pattern utilizes two topics for the request and reply channels, a reply pattern should be derived from the request topic. By default, the name of the reply topic is the composite of the request topic name with <code>.reply</code> appended.</p>\n\n<span class=\"filename\">\n  {{ 'hero.controller' | extension: app640a8700301faaa950934967b8443c33ff4e105d.isJsActive }}\n<app-tabs #app640a8700301faaa950934967b8443c33ff4e105d></app-tabs>\n</span><pre><code class=\"language-typescript\">\nonModuleInit() &#123;\n  this.client.subscribeToResponseOf(&#39;hero.get&#39;); // hero.get.reply\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> Kafka reply topic naming conventions can be customized by extending <code>ClientKafka</code> in your own custom provider and overriding the <code>getResponsePatternName</code> method.\n</blockquote>\n\n</div>\n\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { SharedModule } from '../../../shared/shared.module';\nimport { BasicsComponent } from './basics/basics.component';\nimport { CustomTransportComponent } from './custom-transport/custom-transport.component';\nimport { MicroservicesExceptionFiltersComponent } from './exception-filters/exception-filters.component';\nimport { GrpcComponent } from './grpc/grpc.component';\nimport { MicroservicesGuardsComponent } from './guards/guards.component';\nimport { MicroservicesInterceptorsComponent } from './interceptors/interceptors.component';\nimport { MqttComponent } from './mqtt/mqtt.component';\nimport { NatsComponent } from './nats/nats.component';\nimport { MicroservicesPipesComponent } from './pipes/pipes.component';\nimport { RabbitMQComponent } from './rabbitmq/rabbitmq.component';\nimport { KafkaComponent } from './kafka/kafka.component';\nimport { RedisComponent } from './redis/redis.component';\n\nconst routes: Routes = [\n  {\n    path: 'basics',\n    component: BasicsComponent,\n    data: { title: 'Microservices' },\n  },\n  {\n    path: 'redis',\n    component: RedisComponent,\n    data: { title: 'Redis - Microservices' },\n  },\n  {\n    path: 'mqtt',\n    component: MqttComponent,\n    data: { title: 'MQTT - Microservices' },\n  },\n  {\n    path: 'nats',\n    component: NatsComponent,\n    data: { title: 'NATS - Microservices' },\n  },\n  {\n    path: 'grpc',\n    component: GrpcComponent,\n    data: { title: 'gRPC - Microservices' },\n  },\n  {\n    path: 'rabbitmq',\n    component: RabbitMQComponent,\n    data: { title: 'RabbitMQ - Microservices' },\n  },\n  {\n    path: 'kafka',\n    component: KafkaComponent,\n    data: { title: 'Kafka - Microservices' },\n  },\n  {\n    path: 'pipes',\n    component: MicroservicesPipesComponent,\n    data: { title: 'Pipes - Microservices' },\n  },\n  {\n    path: 'exception-filters',\n    component: MicroservicesExceptionFiltersComponent,\n    data: { title: 'Exception Filters - Microservices' },\n  },\n  {\n    path: 'guards',\n    component: MicroservicesGuardsComponent,\n    data: { title: 'Guards - Microservices' },\n  },\n  {\n    path: 'interceptors',\n    component: MicroservicesInterceptorsComponent,\n    data: { title: 'Interceptors - Microservices' },\n  },\n  {\n    path: 'custom-transport',\n    component: CustomTransportComponent,\n    data: { title: 'Custom Transport - Microservices' },\n  },\n];\n\n@NgModule({\n  imports: [CommonModule, SharedModule, RouterModule.forChild(routes)],\n  declarations: [\n    BasicsComponent,\n    RedisComponent,\n    CustomTransportComponent,\n    MicroservicesExceptionFiltersComponent,\n    MicroservicesPipesComponent,\n    MicroservicesInterceptorsComponent,\n    MicroservicesGuardsComponent,\n    MqttComponent,\n    GrpcComponent,\n    RabbitMQComponent,\n    NatsComponent,\n    KafkaComponent,\n  ],\n})\nexport class MicroservicesModule {}\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-mqtt',\n  templateUrl: './mqtt.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class MqttComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/mqtt.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"mqtt\">MQTT</h3>\n<p><a rel='nofollow' target='_blank' href=\"http://mqtt.org/\">MQTT</a> (Message Queuing Telemetry Transport) is an open source, lightweight messaging protocol, optimized for high-latency. This protocol provides a scalable and cost-efficient way to connect devices using a <strong>publish/subscribe</strong> model. A communication system built on MQTT consists of the publishing server, a broker and one or more clients. It is designed for constrained devices and low-bandwidth, high-latency or unreliable networks.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To start building MQTT-based microservices, first install the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save mqtt</code></pre>\n<h4 appAnchor id=\"overview\"><span>Overview</span></h4>\n<p>To use the MQTT transporter, pass the following options object to the <code>createMicroservice()</code> method:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app7d36b67fbc4f1f9f51d82e4507d40e737999b88d.isJsActive }}\n<app-tabs #app7d36b67fbc4f1f9f51d82e4507d40e737999b88d></app-tabs>\n</span><pre><code class=\"language-typescript\">\nconst app = await NestFactory.createMicroservice(ApplicationModule, &#123;\n  transport: Transport.MQTT,\n  options: &#123;\n    host: &#39;localhost&#39;,\n    port: 1883,\n  &#125;,\n&#125;);</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>Transport</code> enum is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<h4 appAnchor id=\"options\"><span>Options</span></h4>\n<p>The <code>options</code> object is specific to the chosen transporter. The <strong>MQTT</strong> transporter exposes the properties described <a rel='nofollow' target='_blank' href=\"https://github.com/mqttjs/MQTT.js/#mqttclientstreambuilder-options\">here</a>.</p>\n<h4 appAnchor id=\"client\"><span>Client</span></h4>\n<p>Like other microservice transporters, you have <a href=\"https://docs.nestjs.com/microservices/basics#client\">several options</a> for creating a MQTT <code>ClientProxy</code> instance.</p>\n<p>One method for creating an instance is to use use the <code>ClientsModule</code>. To create a client instance with the <code>ClientsModule</code>, import it and use the <code>register()</code> method to pass an options object with the same properties shown above in the <code>createMicroservice()</code> method, as well as a <code>name</code> property to be used as the injection token. Read more about <code>ClientsModule</code> <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    ClientsModule.register([\n      &#123;\n        name: &#39;MATH_SERVICE&#39;,\n        transport: Transport.MQTT,\n        options: &#123;\n          host: &#39;localhost&#39;,\n          port: 1883,\n        &#125;\n      &#125;,\n    ]),\n  ]\n  ...\n&#125;)</code></pre>\n<p>Other options to create a client (either <code>ClientProxyFactory</code> or <code>@Client()</code>) can be used as well. You can read about them <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<h4 appAnchor id=\"context\"><span>Context</span></h4>\n<p>In more sophisticated scenarios, you may want to access more information about the incoming request. When using the MQTT transporter, you can access the <code>MqttContext</code> object.</p>\n\n<span class=\"filename\">\n<app-tabs #app561572aefe841a6d4ffe6d38a7b75ae6600904ad></app-tabs>\n</span><pre [class.hide]=\"app561572aefe841a6d4ffe6d38a7b75ae6600904ad.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(@Payload() data: number[], @Ctx() context: MqttContext) &#123;\n  console.log(`Topic: $&#123;context.getTopic()&#125;`);\n&#125;</code></pre>\n<pre [class.hide]=\"!app561572aefe841a6d4ffe6d38a7b75ae6600904ad.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(data, context) &#123;\n  console.log(`Topic: $&#123;context.getTopic()&#125;`);\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> <code>@Payload()</code>, <code>@Ctx()</code> and <code>MqttContext</code> are imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<p>To access the original mqtt <a rel='nofollow' target='_blank' href=\"https://github.com/mqttjs/mqtt-packet\">packet</a>, use the <code>getPacket()</code> method of the <code>MqttContext</code> object, as follows:</p>\n\n<span class=\"filename\">\n<app-tabs #appc11d7edd73178776b487680491aa37f19c595ff9></app-tabs>\n</span><pre [class.hide]=\"appc11d7edd73178776b487680491aa37f19c595ff9.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(@Payload() data: number[], @Ctx() context: MqttContext) &#123;\n  console.log(context.getPacket());\n&#125;</code></pre>\n<pre [class.hide]=\"!appc11d7edd73178776b487680491aa37f19c595ff9.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(data, context) &#123;\n  console.log(context.getPacket());\n&#125;</code></pre>\n</div>\n\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-nats',\n  templateUrl: './nats.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class NatsComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/nats.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"nats\">NATS</h3>\n<p><a rel='nofollow' target='_blank' href=\"https://nats.io\">NATS</a> is a simple, secure and high performance open source messaging system for cloud native applications, IoT messaging, and microservices architectures. The NATS server is written in the Go programming language, but client libraries to interact with the server are available for dozens of major programming languages. NATS supports both <strong>At Most Once</strong> and <strong>At Least Once</strong> delivery. It can run anywhere, from large servers and cloud instances, through edge gateways and even Internet of Things devices.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To start building NATS-based microservices, first install the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save nats</code></pre>\n<h4 appAnchor id=\"overview\"><span>Overview</span></h4>\n<p>To use the NATS transporter, pass the following options object to the <code>createMicroservice()</code> method:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: appd47dfc3fcafa2d4610bdc17399fc68e2254783d1.isJsActive }}\n<app-tabs #appd47dfc3fcafa2d4610bdc17399fc68e2254783d1></app-tabs>\n</span><pre><code class=\"language-typescript\">\nconst app = await NestFactory.createMicroservice(ApplicationModule, &#123;\n  transport: Transport.NATS,\n  options: &#123;\n    url: &#39;nats://localhost:4222&#39;,\n  &#125;,\n&#125;);</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>Transport</code> enum is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<h4 appAnchor id=\"options\"><span>Options</span></h4>\n<p>The <code>options</code> object is specific to the chosen transporter. The <strong>NATS</strong> transporter exposes the properties described <a rel='nofollow' target='_blank' href=\"https://github.com/nats-io/node-nats#connect-options\">here</a>.\nAdditionally, there is a <code>queue</code> property which allows you to specify the name of the queue that your server should subscribe to (leave <code>undefined</code> to ignore this setting). Read more about NATS queue groups <a href=\"https://docs.nestjs.com/microservices/nats#queue-groups\">below</a>.</p>\n<h4 appAnchor id=\"client\"><span>Client</span></h4>\n<p>Like other microservice transporters, you have <a href=\"https://docs.nestjs.com/microservices/basics#client\">several options</a> for creating a NATS <code>ClientProxy</code> instance.</p>\n<p>One method for creating an instance is to use use the <code>ClientsModule</code>. To create a client instance with the <code>ClientsModule</code>, import it and use the <code>register()</code> method to pass an options object with the same properties shown above in the <code>createMicroservice()</code> method, as well as a <code>name</code> property to be used as the injection token. Read more about <code>ClientsModule</code> <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    ClientsModule.register([\n      &#123;\n        name: &#39;MATH_SERVICE&#39;,\n        transport: Transport.NATS,\n        options: &#123;\n          url: &#39;nats://localhost:4222&#39;,\n        &#125;\n      &#125;,\n    ]),\n  ]\n  ...\n&#125;)</code></pre>\n<p>Other options to create a client (either <code>ClientProxyFactory</code> or <code>@Client()</code>) can be used as well. You can read about them <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<h4 appAnchor id=\"request-response\"><span>Request-response</span></h4>\n<p>For the <strong>request-response</strong> message style (<a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/microservices/basics#request-response\">read more</a>), the NATS transporter uses NATS built-in <a rel='nofollow' target='_blank' href=\"https://docs.nats.io/nats-concepts/reqreply\">Request-Reply</a> mechanism. A request is published on a given subject with a reply subject, and responders listen on that subject and send responses to the reply subject. Reply subjects are usually a subject called an <code>_INBOX</code> that will be directed back to the requestor dynamically, regardless of location of either party.</p>\n<h4 appAnchor id=\"event-based\"><span>Event-based</span></h4>\n<p>For the <strong>event-based</strong> message style (<a rel='nofollow' target='_blank' href=\"https://docs.nestjs.com/microservices/basics#event-based\">read more</a>), the NATS transporter uses NATS built-in <a rel='nofollow' target='_blank' href=\"https://docs.nats.io/nats-concepts/pubsub\">Publish-Subscribe</a> mechanism. A publisher sends a message on a subject and any active subscriber listening on that subject receives the message. Subscribers can also register interest in wildcard subjects that work a bit like a regular expression. This one-to-many pattern is sometimes called fan-out.</p>\n<h4 appAnchor id=\"queue-groups\"><span>Queue groups</span></h4>\n<p>NATS provides a built-in load balancing feature called <a rel='nofollow' target='_blank' href=\"https://docs.nats.io/nats-concepts/queue\">distributed queues</a>. To create a queue subscription, use the <code>queue</code> property as follows:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app0dd527d3c1521878cb985ba33bc63661a5d5ddfc.isJsActive }}\n<app-tabs #app0dd527d3c1521878cb985ba33bc63661a5d5ddfc></app-tabs>\n</span><pre><code class=\"language-typescript\">\nconst app = await NestFactory.createMicroservice(ApplicationModule, &#123;\n  transport: Transport.NATS,\n  options: &#123;\n    url: &#39;nats://localhost:4222&#39;,\n    queue: &#39;cats_queue&#39;,\n  &#125;,\n&#125;);</code></pre><h4 appAnchor id=\"context\"><span>Context</span></h4>\n<p>In more sophisticated scenarios, you may want to access more information about the incoming request. When using the NATS transporter, you can access the <code>NatsContext</code> object.</p>\n\n<span class=\"filename\">\n<app-tabs #appb2346e7b2a35424ae6b3dc0a27f8e6799ff21f4d></app-tabs>\n</span><pre [class.hide]=\"appb2346e7b2a35424ae6b3dc0a27f8e6799ff21f4d.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(@Payload() data: number[], @Ctx() context: NatsContext) &#123;\n  console.log(`Subject: $&#123;context.getSubject()&#125;`);\n&#125;</code></pre>\n<pre [class.hide]=\"!appb2346e7b2a35424ae6b3dc0a27f8e6799ff21f4d.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(data, context) &#123;\n  console.log(`Subject: $&#123;context.getSubject()&#125;`);\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> <code>@Payload()</code>, <code>@Ctx()</code> and <code>NatsContext</code> are imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n\n</div>\n\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-pipes',\n  templateUrl: './pipes.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class MicroservicesPipesComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/pipes.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"pipes\">Pipes</h3>\n<p>There is no fundamental difference between <a routerLink=\"/pipes\">regular pipes</a> and microservices pipes. The only difference is that instead of throwing <code>HttpException</code>, you should use <code>RpcException</code>.</p>\n<blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>RpcException</code> class is exposed from <code>@nestjs/microservices</code> package.\n</blockquote>\n<h4 appAnchor id=\"binding-pipes\"><span>Binding pipes</span></h4>\n<p>The following example uses a manually instantiated method-scoped pipe. Just as with HTTP based applications, you can also use controller-scoped pipes (i.e., prefix the controller class with a <code>@UsePipes()</code> decorator).</p>\n\n<span class=\"filename\">\n<app-tabs #appbe44700bebabf90d8bc990865c608b5e5428a7d7></app-tabs>\n</span><pre [class.hide]=\"appbe44700bebabf90d8bc990865c608b5e5428a7d7.isJsActive\"><code class=\"language-typescript\">\n@UsePipes(new ValidationPipe())\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data: number[]): number &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre>\n<pre [class.hide]=\"!appbe44700bebabf90d8bc990865c608b5e5428a7d7.isJsActive\"><code class=\"language-typescript\">\n@UsePipes(new ValidationPipe())\n@MessagePattern(&#123; cmd: &#39;sum&#39; &#125;)\naccumulate(data) &#123;\n  return (data || []).reduce((a, b) =&gt; a + b);\n&#125;</code></pre>\n</div>\n\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-rabbitmq',\n  templateUrl: './rabbitmq.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RabbitMQComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/rabbitmq.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"rabbitmq\">RabbitMQ</h3>\n<p><a rel='nofollow' target='_blank' href=\"https://www.rabbitmq.com/\">RabbitMQ</a> is an open-source and lightweight message broker which supports multiple messaging protocols. It can be deployed in distributed and federated configurations to meet high-scale, high-availability requirements. In addition, it&#39;s the most widely deployed message broker, used worldwide at small startups and large enterprises.</p>\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To start building RabbitMQ-based microservices, first install the required packages:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save amqplib amqp-connection-manager</code></pre>\n<h4 appAnchor id=\"overview\"><span>Overview</span></h4>\n<p>To use the RabbitMQ transporter, pass the following options object to the <code>createMicroservice()</code> method:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app4c04b896ca657c0410539e04cd9e5fa63fedd344.isJsActive }}\n<app-tabs #app4c04b896ca657c0410539e04cd9e5fa63fedd344></app-tabs>\n</span><pre><code class=\"language-typescript\">\nconst app = await NestFactory.createMicroservice(ApplicationModule, &#123;\n  transport: Transport.RMQ,\n  options: &#123;\n    urls: [&#39;amqp://localhost:5672&#39;],\n    queue: &#39;cats_queue&#39;,\n    queueOptions: &#123;\n      durable: false\n    &#125;,\n  &#125;,\n&#125;);</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>Transport</code> enum is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<h4 appAnchor id=\"options\"><span>Options</span></h4>\n<p>The <code>options</code> property is specific to the chosen transporter. The <strong>RabbitMQ</strong> transporter exposes the properties described below.</p>\n<table>\n  <tr>\n    <td><code>urls</code></td>\n    <td>Connection urls</td>\n  </tr>\n  <tr>\n    <td><code>queue</code></td>\n    <td>Queue name which your server will listen to</td>\n  </tr>\n  <tr>\n    <td><code>prefetchCount</code></td>\n    <td>Sets the prefetch count for the channel</td>\n  </tr>\n  <tr>\n    <td><code>isGlobalPrefetchCount</code></td>\n    <td>Enables per channel prefetching</td>\n  </tr>\n  <tr>\n    <td><code>noAck</code></td>\n    <td>If <code>false</code>, manual acknowledgment mode enabled</td>\n  </tr>\n  <tr>\n    <td><code>queueOptions</code></td>\n    <td>Additional queue options (read more <a href=\"https://www.squaremobius.net/amqp.node/channel_api.html#assertQueue\" rel=\"nofollow\" target=\"_blank\">here</a>)</td>\n  </tr>\n  <tr>\n    <td><code>socketOptions</code></td>\n    <td>Additional socket options (read more <a href=\"https://www.squaremobius.net/amqp.node/channel_api.html#socket-options\" rel=\"nofollow\" target=\"_blank\">here</a>)</td>\n  </tr>\n</table>\n\n<h4 appAnchor id=\"client\"><span>Client</span></h4>\n<p>Like other microservice transporters, you have <a href=\"https://docs.nestjs.com/microservices/basics#client\">several options</a> for creating a RabbitMQ <code>ClientProxy</code> instance.</p>\n<p>One method for creating an instance is to use use the <code>ClientsModule</code>. To create a client instance with the <code>ClientsModule</code>, import it and use the <code>register()</code> method to pass an options object with the same properties shown above in the <code>createMicroservice()</code> method, as well as a <code>name</code> property to be used as the injection token. Read more about <code>ClientsModule</code> <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    ClientsModule.register([\n      &#123;\n        name: &#39;MATH_SERVICE&#39;,\n        transport: Transport.RMQ,\n        options: &#123;\n          urls: [&#39;amqp://localhost:5672&#39;],\n          queue: &#39;cats_queue&#39;,\n          queueOptions: &#123;\n            durable: false\n          &#125;,\n        &#125;,\n      &#125;,\n    ]),\n  ]\n  ...\n&#125;)</code></pre>\n<p>Other options to create a client (either <code>ClientProxyFactory</code> or <code>@Client()</code>) can be used as well. You can read about them <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<h4 appAnchor id=\"context\"><span>Context</span></h4>\n<p>In more sophisticated scenarios, you may want to access more information about the incoming request. When using the RabbitMQ transporter, you can access the <code>RmqContext</code> object.</p>\n\n<span class=\"filename\">\n<app-tabs #appbcea41cb9b7e365a14bf932c592080f18f6febd1></app-tabs>\n</span><pre [class.hide]=\"appbcea41cb9b7e365a14bf932c592080f18f6febd1.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(@Payload() data: number[], @Ctx() context: RmqContext) &#123;\n  console.log(`Pattern: $&#123;context.getPattern()&#125;`);\n&#125;</code></pre>\n<pre [class.hide]=\"!appbcea41cb9b7e365a14bf932c592080f18f6febd1.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(data, context) &#123;\n  console.log(`Pattern: $&#123;context.getPattern()&#125;`);\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> <code>@Payload()</code>, <code>@Ctx()</code> and <code>RmqContext</code> are imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<p>To access the original RabbitMQ message (with the <code>properties</code>, <code>fields</code>, and <code>content</code>), use the <code>getMessage()</code> method of the <code>RmqContext</code> object, as follows:</p>\n\n<span class=\"filename\">\n<app-tabs #app8207b6d4445bf3bd81aa93d5a0144f5dea7aefa5></app-tabs>\n</span><pre [class.hide]=\"app8207b6d4445bf3bd81aa93d5a0144f5dea7aefa5.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(@Payload() data: number[], @Ctx() context: RmqContext) &#123;\n  console.log(context.getMessage());\n&#125;</code></pre>\n<pre [class.hide]=\"!app8207b6d4445bf3bd81aa93d5a0144f5dea7aefa5.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(data, context) &#123;\n  console.log(context.getMessage());\n&#125;</code></pre><p>To retrieve a reference to the RabbitMQ <a rel='nofollow' target='_blank' href=\"https://www.rabbitmq.com/channels.html\">channel</a>, use the <code>getChannelRef</code> method of the <code>RmqContext</code> object, as follows:</p>\n\n<span class=\"filename\">\n<app-tabs #app4fe9dd974277bdb5b5b993092ce41ee29f011d3d></app-tabs>\n</span><pre [class.hide]=\"app4fe9dd974277bdb5b5b993092ce41ee29f011d3d.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(@Payload() data: number[], @Ctx() context: RmqContext) &#123;\n  console.log(context.getChannelRef());\n&#125;</code></pre>\n<pre [class.hide]=\"!app4fe9dd974277bdb5b5b993092ce41ee29f011d3d.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(data, context) &#123;\n  console.log(context.getChannelRef());\n&#125;</code></pre><h4 appAnchor id=\"message-acknowledgement\"><span>Message acknowledgement</span></h4>\n<p>To make sure a message is never lost, RabbitMQ supports <a rel='nofollow' target='_blank' href=\"https://www.rabbitmq.com/confirms.html\">message acknowledgements</a>. An acknowledgement is sent back by the consumer to tell RabbitMQ that a particular message has been received, processed and that RabbitMQ is free to delete it. If a consumer dies (its channel is closed, connection is closed, or TCP connection is lost) without sending an ack, RabbitMQ will understand that a message wasn&#39;t processed fully and will re-queue it.</p>\n<p>To enable manual acknowledgment mode, set the <code>noAck</code> property to <code>false</code>:</p>\n<pre><code class=\"language-typescript\">\noptions: &#123;\n  urls: [&#39;amqp://localhost:5672&#39;],\n  queue: &#39;cats_queue&#39;,\n  noAck: false,\n  queueOptions: &#123;\n    durable: false\n  &#125;,\n&#125;,</code></pre>\n<p>When manual consumer acknowledgements are turned on, we must send a proper acknowledgement from the worker to signal that we are done with a task.</p>\n\n<span class=\"filename\">\n<app-tabs #appaf9aae581c4e770abd9c845f3ed486240d4a3049></app-tabs>\n</span><pre [class.hide]=\"appaf9aae581c4e770abd9c845f3ed486240d4a3049.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(@Payload() data: number[], @Ctx() context: RmqContext) &#123;\n  const channel = context.getChannelRef();\n  const originalMsg = context.getMessage();\n\n  channel.ack(originalMsg);\n&#125;</code></pre>\n<pre [class.hide]=\"!appaf9aae581c4e770abd9c845f3ed486240d4a3049.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(data, context) &#123;\n  const channel = context.getChannelRef();\n  const originalMsg = context.getMessage();\n\n  channel.ack(originalMsg);\n&#125;</code></pre>\n</div>\n\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\nimport { BasePageComponent } from '../../page/page.component';\n\n@Component({\n  selector: 'app-redis',\n  templateUrl: './redis.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RedisComponent extends BasePageComponent {}\n","\n<div class=\"content\" #contentReference>\n  <div class=\"github-links\">\n    <a\n      href=\"https://github.com/nestjs/docs.nestjs.com/edit/master/content/microservices/redis.md\"\n      aria-label=\"Suggest Edits\"\n      title=\"Suggest Edits\"\n    >\n      <i class=\"fas fa-edit\"></i>\n    </a>\n  </div>\n  <h3 id=\"redis\">Redis</h3>\n<p>The <a rel='nofollow' target='_blank' href=\"https://redis.io/\">Redis</a> transporter implements the publish/subscribe messaging paradigm and leverages the <a rel='nofollow' target='_blank' href=\"https://redis.io/topics/pubsub\">Pub/Sub</a> feature of Redis. Published messages are categorized in channels, without knowing what subscribers (if any) will eventually receive the message. Each microservice can subscribe to any number of channels. In addition, more than one channel can be subscribed to at a time. Messages exchanged through channels are <strong>fire-and-forget</strong>, which means that if a message is published and there are no subscribers interested in it, the message is removed and cannot be recovered. Thus, you don&#39;t have a guarantee that either messages or events will be handled by at least one service. A single message can be subscribed to (and received) by multiple subscribers.</p>\n<figure><img src=\"/assets/Redis_1.png\" /></figure>\n\n<h4 appAnchor id=\"installation\"><span>Installation</span></h4>\n<p>To start building Redis-based microservices, first install the required package:</p>\n<pre><code class=\"language-bash\">\n$ npm i --save redis</code></pre>\n<h4 appAnchor id=\"overview\"><span>Overview</span></h4>\n<p>To use the Redis transporter, pass the following options object to the <code>createMicroservice()</code> method:</p>\n\n<span class=\"filename\">\n  {{ 'main' | extension: app9126f6c72218068f62eee4bc4c03fb538478bd04.isJsActive }}\n<app-tabs #app9126f6c72218068f62eee4bc4c03fb538478bd04></app-tabs>\n</span><pre><code class=\"language-typescript\">\nconst app = await NestFactory.createMicroservice(ApplicationModule, &#123;\n  transport: Transport.REDIS,\n  options: &#123;\n    url: &#39;redis://localhost:6379&#39;,\n  &#125;,\n&#125;);</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> The <code>Transport</code> enum is imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n<h4 appAnchor id=\"options\"><span>Options</span></h4>\n<p>The <code>options</code> property is specific to the chosen transporter. The <strong>Redis</strong> transporter exposes the properties described below.</p>\n<table>\n  <tr>\n    <td><code>url</code></td>\n    <td>Connection url</td>\n  </tr>\n  <tr>\n    <td><code>retryAttempts</code></td>\n    <td>Number of times to retry message (default: <code>0</code>)</td>\n  </tr>\n  <tr>\n    <td><code>retryDelay</code></td>\n    <td>Delay between message retry attempts (ms) (default: <code>0</code>)</td>\n  </tr>\n</table>\n\n<h4 appAnchor id=\"client\"><span>Client</span></h4>\n<p>Like other microservice transporters, you have <a href=\"https://docs.nestjs.com/microservices/basics#client\">several options</a> for creating a Redis <code>ClientProxy</code> instance.</p>\n<p>One method for creating an instance is to use use the <code>ClientsModule</code>. To create a client instance with the <code>ClientsModule</code>, import it and use the <code>register()</code> method to pass an options object with the same properties shown above in the <code>createMicroservice()</code> method, as well as a <code>name</code> property to be used as the injection token. Read more about <code>ClientsModule</code> <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<pre><code class=\"language-typescript\">\n@Module(&#123;\n  imports: [\n    ClientsModule.register([\n      &#123;\n        name: &#39;MATH_SERVICE&#39;,\n        transport: Transport.REDIS,\n        options: &#123;\n          url: &#39;redis://localhost:6379&#39;,\n        &#125;\n      &#125;,\n    ]),\n  ]\n  ...\n&#125;)</code></pre>\n<p>Other options to create a client (either <code>ClientProxyFactory</code> or <code>@Client()</code>) can be used as well. You can read about them <a href=\"https://docs.nestjs.com/microservices/basics#client\">here</a>.</p>\n<h4 appAnchor id=\"context\"><span>Context</span></h4>\n<p>In more sophisticated scenarios, you may want to access more information about the incoming request. When using the Redis transporter, you can access the <code>RedisContext</code> object.</p>\n\n<span class=\"filename\">\n<app-tabs #app6abe7f555a7d7e90d6a56814f5c09b2df3597963></app-tabs>\n</span><pre [class.hide]=\"app6abe7f555a7d7e90d6a56814f5c09b2df3597963.isJsActive\"><code class=\"language-typescript\">\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(@Payload() data: number[], @Ctx() context: RedisContext) &#123;\n  console.log(`Channel: $&#123;context.getChannel()&#125;`);\n&#125;</code></pre>\n<pre [class.hide]=\"!app6abe7f555a7d7e90d6a56814f5c09b2df3597963.isJsActive\"><code class=\"language-typescript\">\n@Bind(Payload(), Ctx())\n@MessagePattern(&#39;notifications&#39;)\ngetNotifications(data, context) &#123;\n  console.log(`Channel: $&#123;context.getChannel()&#125;`);\n&#125;</code></pre><blockquote class=\"\ninfo \"><strong>Hint</strong> <code>@Payload()</code>, <code>@Ctx()</code> and <code>RedisContext</code> are imported from the <code>@nestjs/microservices</code> package.\n</blockquote>\n\n</div>\n\n"]}